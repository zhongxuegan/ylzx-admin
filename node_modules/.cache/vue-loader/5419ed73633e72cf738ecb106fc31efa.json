{"remainingRequest":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\src\\main\\news\\article_management.vue?vue&type=style&index=0&id=1f3c1eeb&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\src\\main\\news\\article_management.vue","mtime":1598089264113},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimg {\r\n\tobject-fit: contain;\r\n}\r\n.crop-input {\r\n\tposition: absolute;\r\n\twidth: 100px;\r\n\theight: 40px;\r\n\tleft: 0;\r\n\ttop: 0;\r\n\topacity: 0;\r\n\tcursor: pointer;\r\n}\r\n.handle-box {\r\n\tmargin-bottom: 15px;\r\n}\r\n\r\n.handle-select {\r\n\twidth: 120px;\r\n}\r\n\r\n.handle-input {\r\n\twidth: 200px;\r\n\tdisplay: inline-block;\r\n}\r\n.del-dialog-cnt {\r\n\tfont-size: 16px;\r\n\ttext-align: center;\r\n}\r\n.table {\r\n\twidth: 100%;\r\n\tfont-size: 14px;\r\n}\r\n.red {\r\n\tcolor: #ff0000;\r\n}\r\n.mr10 {\r\n\tmargin-right: 10px;\r\n}\r\n.checkboxGroup:not(:last-child) {\r\n\tborder-bottom: 1px solid #ccc;\r\n}\r\n.flex--wrap {\r\n\tdisplay: flex;\r\n\talign-items: flex-end;\r\n}\r\n.avatar {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tdisplay: block;\r\n}\r\n.avatar-uploader-icon {\r\n\tfont-size: 28px;\r\n}\r\n",{"version":3,"sources":["article_management.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAy0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"article_management.vue","sourceRoot":"src/main/news","sourcesContent":["<template>\r\n\t<div class=\"\">\r\n\t\t<div class=\"crumbs\">\r\n\t\t\t<el-breadcrumb separator=\"/\">\r\n\t\t\t\t<el-breadcrumb-item>\r\n\t\t\t\t\t<i class=\"el-icon-lx-cascades\"></i>\r\n\t\t\t\t\t文章管理\r\n\t\t\t\t</el-breadcrumb-item>\r\n\t\t\t</el-breadcrumb>\r\n\t\t</div>\r\n\t\t<div class=\"container\">\r\n\t\t\t<div class=\"handle-box\">\r\n\t\t\t\t<el-select v-model=\"select_start\" placeholder=\"状态\" class=\"handle-select mr10\" @change=\"sortChange\">\r\n\t\t\t\t\t<el-option key=\"0\" label=\"全部\" value></el-option>\r\n\t\t\t\t\t<el-option key=\"1\" label=\"上架\" value=\"0\"></el-option>\r\n\t\t\t\t\t<!-- <el-option key=\"2\" label=\"未上架\" value=\"1\"></el-option> -->\r\n\t\t\t\t\t<el-option key=\"3\" label=\"下架\" value=\"2\"></el-option>\r\n\t\t\t\t</el-select>\r\n\t\t\t\t<el-select v-model=\"select_classify\" placeholder=\"分类\" class=\"handle-select mr10\" @change=\"sortChange\">\r\n\t\t\t\t\t<el-option key=\"0\" label=\"全部\" value=\"\"></el-option>\r\n\t\t\t\t\t<el-option v-for=\"item in classifyList\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\"></el-option>\r\n\t\t\t\t</el-select>\r\n\t\t\t\t<el-select v-model=\"addMode\" placeholder=\"上传类型\" class=\"handle-select mr10\" @change=\"sortChange\">\r\n\t\t\t\t\t<el-option key=\"\" label=\"全部\" value></el-option>\r\n\t\t\t\t\t<el-option key=\"0\" label=\"后台发布\" value=\"0\"></el-option>\r\n\t\t\t\t\t<el-option key=\"1\" label=\"用户上传\" value=\"1\"></el-option>\r\n\t\t\t\t</el-select>\r\n\t\t\t\t<el-input v-model=\"select_title\" clearable placeholder=\"文章标题/ID\" class=\"handle-input mr10\"></el-input>\r\n\t\t\t\t<!-- <el-input v-model=\"userId\" placeholder=\"用户ID\" clearable class=\"handle-input mr10\"></el-input> -->\r\n\t\t\t\t<el-button type=\"primary\" @click=\"search\">搜索</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"handleAdd\">新增</el-button>\r\n\t\t\t\t\r\n\t\t\t\t<!-- <el-button type=\"primary\" @click=\"asyncHandle\">同步</el-button> -->\r\n\t\t\t</div>\r\n\t\t\t<div class=\"handle-box\">\r\n\t\t\t\t<el-button type=\"primary\" @click=\"inc\">文章导入</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"handleUpdateAll\">批量操作</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"addTimeTaskArticleList\">添加定时</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"handleCancel\">取消定时</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"handleTopData\">批量置顶</el-button>\r\n\t\t\t</div>\r\n\t\t\t<el-table v-loading=\"tableLoading\" :data=\"tableData\" border class=\"table\" ref=\"multipleTable\" @selection-change=\"handleSelectionChange\">\r\n\t\t\t\t<el-table-column type=\"selection\" width=\"55\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"id\" label=\"ID\" width=\"60\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"title\" label=\"标题\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"coverUrl\" label=\"封面图\" width=\"80\" align=\"center\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<img :src=\"scope.row.coverUrl\" width=\"40\" />\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column prop=\"classify\" label=\"分类\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"soldOutText\" label=\"状态\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"fixState\" :formatter=\"formatState\" label=\"定时状态\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"addMode\" :formatter=\"formatMode\" label=\"添加方式\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"userId\" label=\"用户ID\" sortable align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"regionLabel\" label=\"地址标签\" :formatter=\"formatRegion\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"customLabel\" label=\"自定义标签\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"articlePv\" label=\"文章pv\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"labelTime\" label=\"标签时间\" align=\"center\" width=\"180\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"isTop\" label=\"是否置顶\" :formatter=\"formatTop\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"updateTime\" label=\"更新时间\" sortable width=\"180\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"fixTime\" label=\"定时时间\" sortable width=\"180\" align=\"center\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<span width=\"40\" v-if=\"scope.row.fixState === 1\">{{ scope.row.fixTime }}</span>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column label=\"操作\" width=\"100\" align=\"center\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<el-button type=\"primary\" @click=\"handleEdit(scope.$index, scope.row)\">编辑</el-button>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t</el-table>\r\n\t\t\t<div class=\"pagination\">\r\n\t\t\t\t<el-pagination\r\n\t\t\t\t\tbackground\r\n\t\t\t\t\t:current-page.sync=\"currentPage\"\r\n\t\t\t\t\t@size-change=\"handleSizeChange\"\r\n\t\t\t\t\t@current-change=\"handleCurrentChange\"\r\n\t\t\t\t\t:page-sizes=\"sizes\"\r\n\t\t\t\t\t:page-size=\"size\"\r\n\t\t\t\t\tlayout=\"total, sizes, prev, pager, next, jumper\"\r\n\t\t\t\t\t:total=\"total\"\r\n\t\t\t\t></el-pagination>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<!-- 编辑弹出框 -->\r\n\t\t<el-dialog title=\"编辑\" @close=\"dialogClose\" :visible.sync=\"dialogVisible\" width=\"80%\">\r\n\t\t\t<el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"100px\">\r\n\t\t\t\t<el-form-item label=\"标题\" prop=\"title\"><el-input v-model=\"form.title\" style=\"width: 100%;\" clearable></el-input></el-form-item>\r\n\t\t\t\t<el-form-item label=\"封面\" prop=\"coverUrl\">\r\n\t\t\t\t\t<div class=\"upload-box\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<el-upload\r\n\t\t\t\t\t\t\t\t:action=\"uploadAction\"\r\n\t\t\t\t\t\t\t\tref=\"upload\"\r\n\t\t\t\t\t\t\t\t:data=\"uploadImgData\"\r\n\t\t\t\t\t\t\t\tlist-type=\"picture-card\"\r\n\t\t\t\t\t\t\t\t:headers=\"tokenObj\"\r\n\t\t\t\t\t\t\t\t:show-file-list=\"false\"\r\n\t\t\t\t\t\t\t\t:before-upload=\"onBeforeUploadImage\"\r\n\t\t\t\t\t\t\t\t:on-success=\"(res, file) => {return fileChange(res);}\"\r\n\t\t\t\t\t\t\t\t:on-preview=\"handlePictureCardPreview\">\r\n\t\t\t\t\t\t\t\t<img v-if=\"form.coverUrl\" :src=\"form.coverUrl\" />\r\n\t\t\t\t\t\t\t\t<i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n\t\t\t\t\t\t\t</el-upload>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<el-button class=\"upload-box-btn\" @click=\"handleRemove\">清空</el-button>\r\n\t\t\t\t\t\t<div class=\"tip\">大小不超过1M</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"分类\" prop=\"classifyIds\">\r\n\t\t\t\t\t<el-checkbox-group v-model=\"form.classifyIds\">\r\n\t\t\t\t\t\t<el-checkbox v-for=\"item in classifyList\" name=\"classifyIds\" :label=\"item.id\" :key=\"item.id\">{{ item.name }}</el-checkbox>\r\n\t\t\t\t\t</el-checkbox-group>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"状态\">\r\n\t\t\t\t\t<el-select v-model=\"form.soldOut\" style=\"width: 100%;\">\r\n\t\t\t\t\t\t<!-- <el-option key=\"2\" label=\"未上架\" value=\"1\"></el-option> -->\r\n\t\t\t\t\t\t<el-option key=\"1\" label=\"上架\" value=\"0\"></el-option>\r\n\t\t\t\t\t\t<el-option key=\"3\" label=\"下架\" value=\"2\"></el-option>\r\n\t\t\t\t\t</el-select>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"地区标签\">\r\n\t\t\t\t\t<el-checkbox-group v-model=\"checkedCities\">\r\n\t\t\t\t\t\t<el-checkbox v-for=\"city in provinces\" :label=\"city.name\" :key=\"city.value\">{{ city.value }}</el-checkbox>\r\n\t\t\t\t\t</el-checkbox-group>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"自定义标签\"><el-input type=\"text\" v-model=\"form.customLabel\"></el-input></el-form-item>\r\n\t\t\t\t<el-form-item label=\"是否置顶\">\r\n\t\t\t\t\t<el-switch v-model=\"form.isTop\" active-color=\"#ff0000\" inactive-color=\"#ccc\" active-value=\"1\" inactive-value=\"0\"></el-switch>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"内容\">\r\n\t\t\t\t\t<div class=\"edit_container\"><tinymce :height=\"300\" :childHasChange=\"hasC\" v-model=\"form.content\" /></div>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t</el-form>\r\n\t\t\t<div slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t\t<el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\r\n\t\t\t</div>\r\n\t\t</el-dialog>\r\n\r\n\t\t<!-- 批量操作提示框 -->\r\n\t\t<el-dialog title=\"批量操作\" :visible.sync=\"delVisible\" width=\"300px\" center>\r\n\t\t\t<el-form ref=\"form\" :model=\"update_list\" label-width=\"50px\">\r\n\t\t\t\t<el-form-item label=\"状态\">\r\n\t\t\t\t\t<el-select v-model=\"update_list.soldOut\" style=\"width: 100%;\">\r\n\t\t\t\t\t\t<!-- <el-option key=\"2\" label=\"未上架\" value=\"1\"></el-option> -->\r\n\t\t\t\t\t\t<el-option key=\"1\" label=\"上架\" value=\"0\"></el-option>\r\n\t\t\t\t\t\t<el-option key=\"3\" label=\"下架\" value=\"2\"></el-option>\r\n\t\t\t\t\t</el-select>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t</el-form>\r\n\t\t\t<span slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t\t<el-button @click=\"delVisible = false\">取 消</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"updateList\">确 定</el-button>\r\n\t\t\t</span>\r\n\t\t</el-dialog>\r\n\r\n\t\t<!-- 批量置顶 -->\r\n\t\t<el-dialog title=\"批量置顶\" :visible.sync=\"topDialog\" width=\"300px\" center>\r\n\t\t\t<el-form ref=\"form\" :model=\"topArticleForm\" label-width=\"120px\">\r\n\t\t\t\t<el-form-item label=\"置顶状态开/关\">\r\n\t\t\t\t\t<el-switch v-model=\"topArticleForm.isTop\" active-color=\"#ff0000\" inactive-color=\"#ccc\" active-value=\"1\" inactive-value=\"0\"></el-switch>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t</el-form>\r\n\t\t\t<span slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t\t<el-button @click=\"topDialog = false\">取 消</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"setTopArticleList\">确 定</el-button>\r\n\t\t\t</span>\r\n\t\t</el-dialog>\r\n\t\t<!-- 微信导入 -->\r\n\t\t<el-dialog title=\"文章导入\" :visible.sync=\"updatetVisible\" width=\"80%\" center>\r\n\t\t\t<el-form ref=\"form\" :model=\"edit\" label-width=\"100px\">\r\n\t\t\t\t<el-form-item label=\"类型\">\r\n\t\t\t\t\t<el-select v-model=\"edit.importType\">\r\n\t\t\t\t\t\t<el-option value=\"1\" label=\"微信公众号\"></el-option>\r\n\t\t\t\t\t\t<el-option value=\"2\" label=\"梨视频\"></el-option>\r\n\t\t\t\t\t\t<el-option value=\"3\" label=\"好看视频\"></el-option>\r\n\t\t\t\t\t</el-select>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"url\"><el-input v-model=\"edit.weChatArticleUrl\" style=\"width: 100%;\"></el-input></el-form-item>\r\n\t\t\t\t<el-form-item label=\"分类\">\r\n\t\t\t\t\t<el-checkbox-group v-model=\"edit.classifyIds\">\r\n\t\t\t\t\t\t<el-checkbox v-for=\"item in classifyList\" name=\"wexinClassify\" :label=\"item.id\" :key=\"item.id\">{{ item.name }}</el-checkbox>\r\n\t\t\t\t\t</el-checkbox-group>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"状态\">\r\n\t\t\t\t\t<el-select v-model=\"edit.soldOut\" style=\"width: 100%;\">\r\n\t\t\t\t\t\t<!-- <el-option key=\"2\" label=\"未上架\" value=\"1\"></el-option> -->\r\n\t\t\t\t\t\t<el-option key=\"1\" label=\"上架\" value=\"0\"></el-option>\r\n\t\t\t\t\t\t<el-option key=\"3\" label=\"下架\" value=\"2\"></el-option>\r\n\t\t\t\t\t</el-select>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"地区标签\">\r\n\t\t\t\t\t<el-checkbox-group v-model=\"editCheckedCities\">\r\n\t\t\t\t\t\t<el-checkbox v-for=\"city in provinces\" :label=\"city.value\" :key=\"city.value\">{{ city.value }}</el-checkbox>\r\n\t\t\t\t\t</el-checkbox-group>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<el-form-item label=\"自定义标签\"><el-input type=\"text\" v-model=\"edit.customLabel\"></el-input></el-form-item>\r\n\t\t\t\t<el-form-item label=\"是否置顶\">\r\n\t\t\t\t\t<el-switch v-model=\"edit.isTop\" active-color=\"#ff0000\" inactive-color=\"#ccc\" active-value=\"1\" inactive-value=\"0\"></el-switch>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t\t<div class=\"\" v-if=\"showError\" style=\"color:red;\">错误链接个数：{{ failUrlSize }}</div>\r\n\t\t\t\t<template v-if=\"failUrlList.length > 0\">\r\n\t\t\t\t\t<div style=\"color:red;\" v-for=\"item in failUrlList\" :key=\"item.id\">{{ item }}</div>\r\n\t\t\t\t</template>\r\n\t\t\t</el-form>\r\n\r\n\t\t\t<span slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t\t<el-button @click=\"updatetVisible = false\">取 消</el-button>\r\n\t\t\t\t<el-button @click=\"editWeChart\">执行</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"updatetVisible = false\">关闭</el-button>\r\n\t\t\t</span>\r\n\t\t</el-dialog>\r\n\r\n\t\t<el-dialog title=\"添加定时任务\" :visible.sync=\"timeTaskDialog\" width=\"30%\" center=\"\">\r\n\t\t\t<el-form ref=\"form\" :model=\"timeTaskForm\" label-width=\"100px\">\r\n\t\t\t\t<el-form-item label=\"定时时间\">\r\n\t\t\t\t\t<el-date-picker\r\n\t\t\t\t\t\t:picker-options=\"pickerOptions\"\r\n\t\t\t\t\t\tv-model=\"timeTaskForm.fixTime\"\r\n\t\t\t\t\t\tvalue-format=\"yyyy-MM-dd HH:mm:ss\"\r\n\t\t\t\t\t\ttype=\"datetime\"\r\n\t\t\t\t\t\tplaceholder=\"请选择日期时间\"\r\n\t\t\t\t\t></el-date-picker>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t</el-form>\r\n\t\t\t<span slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t\t<el-button @click=\"timeTaskDialog = false\">取 消</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"addTimeTask\">确 定</el-button>\r\n\t\t\t</span>\r\n\t\t</el-dialog>\r\n\r\n\t\t<el-dialog title=\"同步\" :visible.sync=\"asyncDialog\" width=\"50%\" center>\r\n\t\t\t<el-form ref=\"asyncForm\" :model=\"asyncForm\" label-width=\"140px\">\r\n\t\t\t\t<template v-for=\"item in PlatformClassifyAndPlatformId\">\r\n\t\t\t\t\t<el-form-item :label=\"item.platformName + '文章分类'\" :key=\"item.id\">\r\n\t\t\t\t\t\t<el-checkbox-group v-model=\"item.classifyId\" class=\"checkboxGroup\">\r\n\t\t\t\t\t\t\t<el-checkbox v-for=\"childItem in item.list\" name=\"wechat\" :label=\"childItem.id\" :key=\"childItem.id\">{{ childItem.name }}</el-checkbox>\r\n\t\t\t\t\t\t</el-checkbox-group>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</template>\r\n\t\t\t</el-form>\r\n\t\t\t<span slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t\t<el-button @click=\"asyncDialog = false\">取 消</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"asyncTask\">确 定</el-button>\r\n\t\t\t</span>\r\n\t\t</el-dialog>\r\n\t\t<el-dialog :visible.sync=\"dialogImageVisible\"><img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\" /></el-dialog>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { provinces } from './data';\r\nexport default {\r\n\tname: 'basetable',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tuploadAction: this.BASE_URL + 'admin/upload/uploadImgByType',\r\n\t\t\ttokenObj: { token: localStorage.getItem('token') },\r\n\t\t\tuploadImgData: { type: '1' },\r\n\t\t\tdialogImageUrl: '',\r\n\t\t\tdialogImageVisible: false,\r\n\t\t\thasC: false, // 富文本在编辑切换的时候不会改变，利用这个变量来控制他的改变\r\n\t\t\turl: this.BASE_URL + 'admin/article/list',\r\n\t\t\ttableData: [],\r\n\t\t\ttableLoading:true,\r\n\t\t\tcurrentPage: 1,\r\n\t\t\tpage: 1,\r\n\t\t\tsize: 10,\r\n\t\t\tsizes: [10, 20, 50, 100],\r\n\t\t\tselect_start: null,\r\n\t\t\tselect_title: '',\r\n\t\t\tselect_classify: null,\r\n\t\t\tdialogVisible: false, //文章编辑/新增弹窗\r\n\t\t\tupdatetVisible: false,\r\n\t\t\tdelVisible: false,\r\n\t\t\tfailUrlList: [], // 批量更新失败的集合\r\n\t\t\tfailUrlSize: 0, //错误链接个数\r\n\t\t\tshowError: false,\r\n\t\t\taddMode: null,\r\n\t\t\t// userId: null,\r\n\t\t\tcheckedCities: [],\r\n\t\t\teditCheckedCities: [],\r\n\t\t\ttopDialog: false,\r\n\t\t\ttopArticleForm: {\r\n\t\t\t\tids: [],\r\n\t\t\t\tisTop: '1'\r\n\t\t\t},\r\n\t\t\tupdate_list: {\r\n\t\t\t\tids: [],\r\n\t\t\t\tsoldOut: '0'\r\n\t\t\t},\r\n\t\t\trules: {\r\n\t\t\t\ttitle: [{ required: true, message: '请输入文章标题', trigger: 'blur' }],\r\n\t\t\t\tclassifyIds: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttype: 'array',\r\n\t\t\t\t\t\trequired: true,\r\n\t\t\t\t\t\tmessage: '请至少选择一个分类',\r\n\t\t\t\t\t\ttrigger: 'change'\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tedit: {\r\n\t\t\t\tclassifyIds: [],\r\n\t\t\t\tsoldOut: '',\r\n\t\t\t\tweChatArticleUrl: '',\r\n\t\t\t\timportType: ''\r\n\t\t\t},\r\n\t\t\tmultipleSelection: [],\r\n\t\t\tform: {\r\n\t\t\t\ttitle: '',\r\n\t\t\t\tsoldOut: '0',\r\n\t\t\t\tcoverUrl: '',\r\n\t\t\t\tcontent: '',\r\n\t\t\t\tid: '',\r\n\t\t\t\tupdateTime: '',\r\n\t\t\t\tcustomLabel: '',\r\n\t\t\t\tisTop: '0',\r\n\t\t\t\tclassifyIds: []\r\n\t\t\t},\r\n\t\t\tsoldObj: {\r\n\t\t\t\t0: '上架',\r\n\t\t\t\t1: '未上架',\r\n\t\t\t\t2: '下架'\r\n\t\t\t},\r\n\t\t\tclassifyList: [],\r\n\t\t\ttotal: 1,\r\n\t\t\teditorOption: {\r\n\t\t\t\tplaceholder: ''\r\n\t\t\t},\r\n\t\t\ttimeTaskDialog: false,\r\n\t\t\tasyncForm: {},\r\n\t\t\tprovinces: [],\r\n\r\n\t\t\ttimeTaskForm: {\r\n\t\t\t\tids: [],\r\n\t\t\t\tfixTime: '',\r\n\t\t\t\tfixState: 1,\r\n\t\t\t\tsoldOut: '0'\r\n\t\t\t},\r\n\t\t\tasyncDialog: false,\r\n\t\t\tasyncList: [],\r\n\t\t\tcancelList: [],\r\n\t\t\tweChatUrlList: ['http://ky.api.zhuanfa666.com/'],\r\n\t\t\tmultiPlatFormWechatUrl: [{ name: '赚元宝', url: 'http://wz.api.zhuanyuanbao.com/' }, { name: '彩虹快阅', url: 'http://ky.api.zhuanfa666.com/' }],\r\n\t\t\tplatformIds: [1],\r\n\t\t\tmultiPlatFormAsync: [],\r\n\t\t\tmultiBatchList: ['http://ky.api.zhuanfa666.com/'],\r\n\t\t\tpickerOptions: {\r\n\t\t\t\tdisabledDate(time) {\r\n\t\t\t\t\treturn time.getTime() < Date.now() - 24 * 60 * 60 * 1000;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tPlatformClassifyAndPlatformId: [],\r\n\t\t\t//所有平台的分类ID\r\n\t\t\tclassifyAllArr: []\r\n\t\t};\r\n\t},\r\n\tcreated() {\r\n\t\tthis.provinces = provinces;\r\n\t\tthis.getData();\r\n\t\tthis.getClassifyList();\r\n\t},\r\n\tmethods: {\r\n\t\t// 对话框关闭的回调\r\n\t\tformatState(row, column, cellValue, index) {\r\n\t\t\treturn cellValue === 1 ? '已启用' : cellValue === 2 ? '已取消' : '未启用';\r\n\t\t},\r\n\t\tformatTop(row, column, cellValue, index) {\r\n\t\t\treturn cellValue === 1 ? '是' : '否';\r\n\t\t},\r\n\t\tformatRegion(row, column, cellValue, index) {\r\n\t\t\treturn cellValue === 'false' || cellValue === 'true' ? '' : cellValue;\r\n\t\t},\r\n\t\tformatMode(row, column, cellValue, index) {\r\n\t\t\treturn cellValue === 0 ? '后台发布' : cellValue === 1 ? '用户上传' : '后台发布';\r\n\t\t},\r\n\t\tdialogClose() {\r\n\t\t\tthis.hasC = true;\r\n\t\t\tthis.$refs['form'].resetFields();\r\n\t\t},\r\n\r\n\t\tfileChange(res) {\r\n\t\t\t// index: 指向所在那个广告表单\r\n\t\t\tthis.form.coverUrl = res.data;\r\n\t\t},\r\n\t\thandleRemove(){\r\n\t\t\tthis.form.coverUrl = '';\r\n\t\t},\r\n\t\tonBeforeUploadImage(file) {\r\n\t\t\tconst isImg = this.isImage(file.name);\r\n\t\t\tconst isLit2M = this.isLit2M(file.size);\r\n\t\t\treturn isImg && isLit2M;\r\n\t\t},\r\n\t\tisImage(fileName) {\r\n\t\t\t// 判断是否是图片\r\n\t\t\tvar f = fileName;\r\n\t\t\tif (f == null || f == undefined || f == '') {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (!/\\.(?:png|jpg|bmp|gif|PNG|JPG|BMP|GIF|jpeg)$/.test(f)) {\r\n\t\t\t\tthis.$message.error('类型必须是图片(.png|jpg|bmp|gif|PNG|JPG|BMP|GIF)');\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tisLit2M(size) {\r\n\t\t\tif (size / 1024 / 1024 < 2) {\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\tmessage: '图片大小不能超过 2MB!'\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\thandlePictureCardPreview(file) {\r\n\t\t\tthis.dialogImageUrl = file.url;\r\n\t\t\tthis.dialogImageVisible = true;\r\n\t\t},\r\n\r\n\t\t// 批量置顶\r\n\t\tasync setTopArticleList() {\r\n\t\t\tlet postData = this.topArticleForm;\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code }\r\n\t\t\t} = await this.$axios.post(this.BASE_URL + 'admin/article/batch/setTopArticleByIds', postData);\r\n\t\t\tif (+code === 200) {\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\tmessage: '批量置顶/取消置顶成功'\r\n\t\t\t\t});\r\n\t\t\t\tthis.topArticleForm.ids = [];\r\n\t\t\t\tthis.topDialog = false;\r\n\t\t\t\tthis.getData();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// 获取批量置顶的数据\r\n\t\thandleTopData() {\r\n\t\t\tconst length = this.multipleSelection.length;\r\n\t\t\tif (!length > 0) {\r\n\t\t\t\tthis.$message('请先勾选要置顶的文章');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tthis.topArticleForm.ids.push(this.multipleSelection[i].id);\r\n\t\t\t}\r\n\t\t\tthis.topArticleForm.isTop = '1';\r\n\t\t\tthis.topDialog = true;\r\n\t\t},\r\n\r\n\t\tasync getPlatformClassifyData({ platformUrl, id, platformName }) {\r\n\t\t\tlet postData = {\r\n\t\t\t\tparams: {\r\n\t\t\t\t\tpage: 1,\r\n\t\t\t\t\tsize: 100,\r\n\t\t\t\t\tdeleteFlag: '0',\r\n\t\t\t\t\tname: ''\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code, msg, data }\r\n\t\t\t} = await this.$axios.get(platformUrl + 'admin/article/classify/list', postData);\r\n\t\t\tthis.classifyAllArr.push(data.list);\r\n\t\t\tthis.PlatformClassifyAndPlatformId.push({\r\n\t\t\t\tlist: data.list,\r\n\t\t\t\tplatformId: id,\r\n\t\t\t\tplatformName: platformName,\r\n\t\t\t\tclassifyId: []\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tasync getPlatformData() {\r\n\t\t\tlet postData = {\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tplatformName: this.platformName,\r\n\t\t\t\tsize: 100\r\n\t\t\t};\r\n\t\t\tlet {\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tdata: { list }\r\n\t\t\t\t}\r\n\t\t\t} = await this.$axios.post(this.BASE_URL + 'admin/system/listPlatformPage', postData);\r\n\t\t\tthis.multiPlatFormAsync = this.filterPlatform(list);\r\n\r\n\t\t\tfor (let i = 0; i < this.multiPlatFormAsync.length; i++) {\r\n\t\t\t\tthis.getPlatformClassifyData(this.multiPlatFormAsync[i]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfilterPlatform(arr) {\r\n\t\t\tlet result = [];\r\n\t\t\tresult = arr.filter(item => {\r\n\t\t\t\treturn item.id !== 2;\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t},\r\n\r\n\t\tmergePlatformClassifyAndPlatformId(platformIds, platformClassify) {\r\n\t\t\tlet tempArr = [];\r\n\t\t\tfor (let i = 0; i < platformIds.length; i++) {\r\n\t\t\t\ttempArr.push({\r\n\t\t\t\t\tlist: platformClassify[i],\r\n\t\t\t\t\tplatformId: platformIds[i].id,\r\n\t\t\t\t\tplatformName: platformIds[i].platformName\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn tempArr;\r\n\t\t},\r\n\t\tgeneratePostData(arr) {\r\n\t\t\tlet result = [];\r\n\t\t\tfor (let i = 0; i < arr.length; i++) {\r\n\t\t\t\tif (arr[i].classifyId.length > 0) {\r\n\t\t\t\t\tresult.push({\r\n\t\t\t\t\t\tplatformId: arr[i].platformId,\r\n\t\t\t\t\t\tclassifyId: arr[i].classifyId\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t},\r\n\r\n\t\t// 同步\r\n\t\tasyncHandle() {\r\n\t\t\tconst length = this.multipleSelection.length;\r\n\t\t\tif (!length > 0) {\r\n\t\t\t\tthis.$message('请先勾选要修改的文章');\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\tthis.asyncDialog = true;\r\n\t\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\t\tthis.asyncList.push(this.multipleSelection[i].id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync asyncTask() {\r\n\t\t\tlet postData = this.generatePostData(this.PlatformClassifyAndPlatformId);\r\n\t\t\t// let postData = [{platformId:1,classifyId:[1,2,3]},{platformId:2,classifyId:[3,4,5]}]\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code }\r\n\t\t\t} = await this.$axios.post(this.BASE_URL + `admin/skip/syncArticle?ids=${this.asyncList.join(',')}`, postData);\r\n\t\t\tif (+code === 200) {\r\n\t\t\t\tthis.asyncDialog = false;\r\n\t\t\t\tthis.asyncList = [];\r\n\t\t\t\tthis.getData();\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\tmessage: '同步成功'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\thandleCancel() {\r\n\t\t\tconst length = this.multipleSelection.length;\r\n\t\t\tif (!length > 0) {\r\n\t\t\t\tthis.$message('请先勾选要修改的文章');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.$confirm('确认取消', '提示', {\r\n\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\ttype: 'warning'\r\n\t\t\t})\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\t\t\tthis.cancelList.push(parseInt(this.multipleSelection[i].id));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.cancelTask();\r\n\t\t\t\t})\r\n\t\t\t\t.catch(() => {\r\n\t\t\t\t\tthis.cancelList = [];\r\n\t\t\t\t});\r\n\t\t},\r\n\t\t// 取消定时\r\n\t\tasync cancelTask() {\r\n\t\t\tlet postData = {\r\n\t\t\t\tids: this.cancelList,\r\n\t\t\t\tsoldOut: '1',\r\n\t\t\t\tfixState: '0'\r\n\t\t\t};\r\n\r\n\t\t\tlet { code } = await this.$axios.post(this.BASE_URL + 'admin/article/batch/update', JSON.stringify(postData), { headers: { 'Content-Type': 'application/json' } });\r\n\t\t\tthis.getData();\r\n\t\t},\r\n\t\thandleUpdateAll() {\r\n\t\t\tconst length = this.multipleSelection.length;\r\n\t\t\tif (!length > 0) {\r\n\t\t\t\tthis.$message('请先勾选要修改的文章');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tthis.update_list.ids.push(parseInt(this.multipleSelection[i].id));\r\n\t\t\t}\r\n\t\t\tthis.delVisible = true;\r\n\t\t},\r\n\t\taddTimeTaskArticleList() {\r\n\t\t\tconst length = this.multipleSelection.length;\r\n\t\t\tif (!length > 0) {\r\n\t\t\t\tthis.$message('请先勾选要修改的文章');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tthis.timeTaskForm.ids.push(parseInt(this.multipleSelection[i].id));\r\n\t\t\t}\r\n\t\t\tthis.timeTaskDialog = true;\r\n\t\t},\r\n\t\tupdateList() {\r\n\t\t\tif (!this.update_list.ids.length > 0) {\r\n\t\t\t\tthis.$message('文章不存在');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.updateBatch();\r\n\t\t},\r\n\t\t// 批量更新\r\n\t\tasync updateBatch() {\r\n\t\t\tlet { code } = await this.$axios.post(this.BASE_URL + 'admin/article/batch/update', JSON.stringify(this.update_list), {\r\n\t\t\t\theaders: { 'Content-Type': 'application/json' }\r\n\t\t\t});\r\n\t\t\tthis.getData();\r\n\t\t\tthis.update_list.ids = [];\r\n\t\t\tthis.delVisible = false;\r\n\t\t},\r\n\r\n\t\t//添加定时任务\r\n\t\tasync addTimeTask() {\r\n\t\t\ttry{\r\n\t\t\t\tlet { code } = await this.$axios.post(this.BASE_URL + 'admin/article/batch/update', JSON.stringify(this.timeTaskForm), {\r\n\t\t\t\t\theaders: { 'Content-Type': 'application/json' }\r\n\t\t\t\t});\r\n\t\t\t\tthis.getData();\r\n\t\t\t\tthis.timeTaskForm.ids = [];\r\n\t\t\t\tthis.timeTaskDialog = false;\r\n\t\t\t}catch(e){\r\n\t\t\t\tthis.timeTaskForm.ids = [];\r\n\t\t\t}\r\n\t\t},\r\n\t\thandleSelectionChange(val) {\r\n\t\t\tthis.multipleSelection = val;\r\n\t\t},\r\n\t\tonEditorChange({ editor, html, text }) {\r\n\t\t\tthis.form.content = html;\r\n\t\t},\r\n\t\thandleSizeChange(cur_size) {\r\n\t\t\tthis.size = cur_size;\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.page = 1;\r\n\t\t\tthis.getData();\r\n\t\t},\r\n\t\thandleCurrentChange(cur_page) {\r\n\t\t\tthis.page = cur_page;\r\n\t\t\tthis.currentPage = cur_page;\r\n\t\t\tthis.getData();\r\n\t\t},\r\n\t\tsortChange() {\r\n\t\t\tthis.page = 1;\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.tableLoading=true;\r\n\t\t\tthis.getData();\r\n\t\t},\r\n\t\tasync getClassifyList() {\r\n\t\t\tlet postData = {\r\n\t\t\t\tparams: {\r\n\t\t\t\t\tpage: 1,\r\n\t\t\t\t\tsize: 100,\r\n\t\t\t\t\tdeleteFlag: '0',\r\n\t\t\t\t\tname: ''\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code, msg, data }\r\n\t\t\t} = await this.$axios.get(this.BASE_URL + 'admin/article/classify/list', postData);\r\n\t\t\tthis.classifyList = data.list;\r\n\t\t},\r\n\r\n\t\t// 先从classifyList中找出含有classifyIds的数组对象\r\n\t\tcompareList(arr) {\r\n\t\t\tlet tempArr = [];\r\n\t\t\tfor (let i = 0; i < arr.length; i++) {\r\n\t\t\t\tfor (let j = 0; j < this.classifyList.length; j++) {\r\n\t\t\t\t\tif (arr[i] === this.classifyList[j].id) {\r\n\t\t\t\t\t\ttempArr.push(this.classifyList[j]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// let result = this.classifyList.find((item)=>{\r\n\t\t\t\t//    return item.sort === arr[i];\r\n\t\t\t\t// });\r\n\t\t\t\t// if(result){\r\n\t\t\t\t//     tempArr[i] = result;\r\n\t\t\t\t// }\r\n\t\t\t}\r\n\t\t\treturn tempArr;\r\n\t\t},\r\n\r\n\t\t// 将找出来含有classifyIds的数组对象中的名称提取出来到一个数组\r\n\t\tpushNameToList(list) {\r\n\t\t\tlet tempArr = [];\r\n\t\t\tif (!Array.isArray(list)) return;\r\n\t\t\tfor (let i = 0; i < list.length; i++) {\r\n\t\t\t\ttempArr.push(list[i].name);\r\n\t\t\t}\r\n\t\t\treturn tempArr;\r\n\t\t},\r\n\r\n\t\toperateList(arr) {\r\n\t\t\tif (!Array.isArray(arr)) return;\r\n\t\t\tarr.map(item => {\r\n\t\t\t\titem.classify = this.pushNameToList(this.compareList(item.classifyIds)).toString();\r\n\t\t\t\titem.soldOutText = this.soldObj[item.soldOut];\r\n\t\t\t});\r\n\t\t\treturn arr;\r\n\t\t},\r\n\t\tasync getData() {\r\n\t\t\tlet postData = {\r\n\t\t\t\tparams: {\r\n\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\tsize: this.size,\r\n\t\t\t\t\tsoldOut: this.select_start,\r\n\t\t\t\t\ttitle: this.select_title,\r\n\t\t\t\t\tclassifyId: this.select_classify,\r\n\t\t\t\t\taddMode: this.addMode,\r\n\t\t\t\t\t// userId: this.userId\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tlet {\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tdata: { list, total }\r\n\t\t\t\t}\r\n\t\t\t} = await this.$axios.get(this.url, postData);\r\n\t\t\tthis.tableLoading=false;\r\n\t\t\tthis.tableData = this.operateList(list);\r\n\t\t\tthis.total = total;\r\n\t\t},\r\n\t\tsearch() {\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.page = 1;\r\n\t\t\tthis.tableLoading=true;\r\n\t\t\tthis.getData();\r\n\t\t},\r\n\t\t//获取文章的富文本\r\n\t\tasync getArticle(id) {\r\n\t\t\tlet {\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tdata: { content }\r\n\t\t\t\t}\r\n\t\t\t} = await this.$axios.post(this.BASE_URL + 'admin/article/detail/' + id, {});\r\n\t\t\tthis.form.content = content;\r\n\t\t\tthis.hasC = false;\r\n\t\t},\r\n\t\thandleEdit(index, row) {\r\n\t\t\tthis.form = Object.assign(this.form, row);\r\n\t\t\tthis.form.soldOut = this.form.soldOut.toString();\r\n\t\t\tthis.form.isTop = this.form.isTop.toString();\r\n\t\t\tthis.checkedCities = row.regionLabel ? row.regionLabel.split(',') : [];\r\n\t\t\tthis.getArticle(row.id);\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.dialogVisible = true;\r\n\t\t\t}, 20);\r\n\t\t},\r\n\t\thandleAdd() {\r\n\t\t\tthis.$router.push('/article_management_add');\r\n\t\t},\r\n\r\n\t\tinc() {\r\n\t\t\tthis.edit = {\r\n\t\t\t\tsoldOut: '上架',\r\n\t\t\t\tclassifyIds: []\r\n\t\t\t};\r\n\t\t\tthis.failUrlSize = 0;\r\n\t\t\tthis.failUrlList = [];\r\n\t\t\tthis.updatetVisible = true;\r\n\t\t\tthis.showError = false;\r\n\t\t},\r\n\r\n\t\teditWeChart() {\r\n\t\t\tif (this.edit.weChatArticleUrl == '' || this.edit.weChatArticleUrl == null) {\r\n\t\t\t\tthis.$message('微信地址没有填写');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.edit.soldOut == '上架') {\r\n\t\t\t\tthis.edit.soldOut = 0;\r\n\t\t\t} else if (this.edit.soldOut == '未上架') {\r\n\t\t\t\tthis.edit.soldOut = 1;\r\n\t\t\t} else if (this.edit.soldOut == '下架') {\r\n\t\t\t\tthis.edit.soldOut = 2;\r\n\t\t\t}\r\n\t\t\tthis.edit.regionLabel = this.editCheckedCities.join(',');\r\n\t\t\tthis.$axios.post(this.BASE_URL + 'admin/article/add/weChatUrl', this.edit).then(res => {\r\n\t\t\t\tthis.showError = true;\r\n\t\t\t\tif (+res.data.code == 200 && +res.data.data.failUrlSize === 0) {\r\n\t\t\t\t\tthis.updatetVisible = false;\r\n\t\t\t\t\tthis.$message.success(`添加成功`);\r\n\t\t\t\t\tthis.getData();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.failUrlSize = res.data.data.failUrlSize;\r\n\t\t\t\t\tthis.failUrlList = res.data.data.failUrlList;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tformatContent(content){\r\n\t\t\treturn content.replace(/广告区域/g,'<h1>广告区域</h1>');\r\n\t\t},\r\n\t\tasync upadateArticle() {\r\n\t\t\tthis.form.regionLabel = this.checkedCities.length > 0 && this.checkedCities.join(',');\r\n\t\t\tlet postData = JSON.parse(JSON.stringify(this.form));\r\n\t\t\tpostData.content = this.formatContent(postData.content);\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code }\r\n\t\t\t} = await this.$axios.post(this.BASE_URL + 'admin/article/update', postData);\r\n\t\t\tthis.$message.success('修改文章成功');\r\n\t\t\tthis.getData();\r\n\t\t\tthis.dialogVisible = false;\r\n\t\t},\r\n\t\tsubmitForm() {\r\n\t\t\tthis.$refs['form'].validate(valid => {\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\tthis.upadateArticle();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tasync handleTop(data) {\r\n\t\t\tlet { id, isTop } = data;\r\n\t\t\tisTop = isTop ? 0 : 1;\r\n\t\t\tlet url = this.BASE_URL + `admin/article/setTopArticleById/${id}/${isTop}`;\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code, message }\r\n\t\t\t} = await this.$axios.post(url, {});\r\n\t\t\tif (+code === 200) {\r\n\t\t\t\tthis.getData();\r\n\t\t\t\tthis.$message.success('置顶成功');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nimg {\r\n\tobject-fit: contain;\r\n}\r\n.crop-input {\r\n\tposition: absolute;\r\n\twidth: 100px;\r\n\theight: 40px;\r\n\tleft: 0;\r\n\ttop: 0;\r\n\topacity: 0;\r\n\tcursor: pointer;\r\n}\r\n.handle-box {\r\n\tmargin-bottom: 15px;\r\n}\r\n\r\n.handle-select {\r\n\twidth: 120px;\r\n}\r\n\r\n.handle-input {\r\n\twidth: 200px;\r\n\tdisplay: inline-block;\r\n}\r\n.del-dialog-cnt {\r\n\tfont-size: 16px;\r\n\ttext-align: center;\r\n}\r\n.table {\r\n\twidth: 100%;\r\n\tfont-size: 14px;\r\n}\r\n.red {\r\n\tcolor: #ff0000;\r\n}\r\n.mr10 {\r\n\tmargin-right: 10px;\r\n}\r\n.checkboxGroup:not(:last-child) {\r\n\tborder-bottom: 1px solid #ccc;\r\n}\r\n.flex--wrap {\r\n\tdisplay: flex;\r\n\talign-items: flex-end;\r\n}\r\n.avatar {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tdisplay: block;\r\n}\r\n.avatar-uploader-icon {\r\n\tfont-size: 28px;\r\n}\r\n</style>\n"]}]}