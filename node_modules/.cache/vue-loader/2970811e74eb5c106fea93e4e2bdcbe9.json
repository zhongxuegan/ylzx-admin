{"remainingRequest":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\src\\components\\charts\\lineChart.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\src\\components\\charts\\lineChart.vue","mtime":1598325463578},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport echarts from 'echarts'\nimport resize from '../mixins/resize'\n// pv #33b5e5 ip #ffbb33 ad #ff4444 adPercent #9933cc\nvar colors = ['#92d0e6','#f3d395','#e09898','#a36dbd','#33b5e5', '#ffbb33', '#ff4444','#9933cc','#0784b3','#f3a307','#e00707','#69049c'];\nvar day1 = new Date()\nvar day2 = new Date()\nexport default {\n  mixins:[resize],\n  props:{\n    className:{\n      type:String,\n      default:'chart'\n    },\n    id:{\n      type:String,\n      default:'chart'\n    },\n    width:{\n      type:String,\n      default:'200px'\n    },\n    height:{\n      type:String,\n      default:'200px'\n    }\n  },\n  data() {\n    return {\n      chart:null,\n      startDay:null,\n      endDay:null,\n      backPage:1,\n      adposition:2,\n      adTempPosition:2,\n      list:[],\n      axiosData:[],\n      adIpCountByHourList:[],\n      clientIpCountList:[],\n      pvCountByHourList:[],\n      ipPercentRateList:[],\n      // 昨天数据\n      yesterDayadIpCountByHourList:[],\n      yesterDayclientIpCountList:[],\n      yesterDaypvCountByHourList:[],\n      yesterDayipPercentRateList:[],\n      yesterDay:'',\n      // 前天数据\n      theDayBeforeYesterDayadIpCountByHourList:[],\n      theDayBeforeYesterDayclientIpCountList:[],\n      theDayBeforeYesterDaypvCountByHourList:[],\n      theDayBeforeYesteripPercentRateList:[],\n      dayBeforeYesterDay:'',\n      adpositionList:[\n      {\n        value:2,\n        label:'底部'\n      },\n      {\n        value:4,\n        label:'后退页'\n      },\n      {\n        value:1,\n        label:'顶部banner'\n      },\n      {\n        value:3,\n        label:'文字链接'\n      },\n      {\n        value:5,\n        label:'底部悬浮窗'\n      }\n    ],\n    }\n  },\n  mounted() {\n    this.initChart()\n  },\n  created(){\n    this.startDay = this.dateFtt(\"yyyy-MM-dd\",day1, 1)\n    this.endDay = this.dateFtt(\"yyyy-MM-dd\", day1, 1)\n  },\n  beforeDestroy() {\n    if(!this.chart) {\n      return\n    }\n    this.chart.dispose()\n    this.chart = null\n  },\n  methods: {\n  async getData() {\n    if(this.backPage ===2){\n      this.adTempPosition = 2\n    }else{\n      this.adTempPosition = this.adposition\n    }\n    let {data:{data,code}} = await this.$axios.get(this.BASE_URL + `admin/account/lineChartByDate?startDay=${this.startDay}&endDay=${this.endDay}&backPage=${this.backPage}&adPosition=${this.adTempPosition}`)\n    if(+code ===200){\n      this.list = data\n      var yesterDayTime = new Date(this.startDay).getTime() - 86400000\n      var dayBeforeYesterDayTime = new Date(this.startDay).getTime() - 86400000 * 2\n      this.yesterDay= this.dateFtt('yyyy-MM-dd',new Date(yesterDayTime),1)\n      this.dayBeforeYesterDay = this.dateFtt('yyyy-MM-dd',new Date(dayBeforeYesterDayTime),1)\n      this.axiosData = this.generateAxios(data.adIpCountByHourList)\n      // 今日数据\n      var todayAdCountData = this.findDayfromList(data.adIpCountByHourList,this.startDay)\n      var todayClientIpData = this.findDayfromList(data.clientIpCountList,this.startDay)\n      var todaypvCountData = this.findDayfromList(data.pvCountByHourList,this.startDay)\n      var todayipPercentData = this.findDayfromList(data.ipPercentRateList,this.startDay)\n      this.adIpCountByHourList = this.generateyAxios(data.adIpCountByHourList,todayAdCountData)\n      this.clientIpCountList = this.generateyAxios(data.clientIpCountList,todayClientIpData)\n      this.pvCountByHourList = this.generateyAxios(data.pvCountByHourList,todaypvCountData)\n      this.ipPercentRateList = this.addPercentForItem(this.generateyAxios(data.ipPercentRateList,todayipPercentData))\n      \n        // 昨日数据\n      var yesterDayAdCountData = this.findDayfromList(data.adIpCountByHourList,this.yesterDay)\n      var yesterDayClientIpData = this.findDayfromList(data.clientIpCountList,this.yesterDay)\n      var yesterDaypvCountData = this.findDayfromList(data.pvCountByHourList,this.yesterDay)\n      var yesterDayipPercentData = this.findDayfromList(data.ipPercentRateList,this.yesterDay)\n      this.yesterDayadIpCountByHourList = this.generateyAxios(data.adIpCountByHourList,yesterDayAdCountData)\n      this.yesterDayclientIpCountList = this.generateyAxios(data.clientIpCountList,yesterDayClientIpData)\n      this.yesterDaypvCountByHourList = this.generateyAxios(data.pvCountByHourList,yesterDaypvCountData)\n      this.yesterDayipPercentRateList = this.addPercentForItem(this.generateyAxios(data.ipPercentRateList,yesterDayipPercentData))\n\n        // 前天数据\n      var dayBeforeYesterDayAdCountData = this.findDayfromList(data.adIpCountByHourList,this.dayBeforeYesterDay)\n      var dayBeforeYesterDayClientIpData = this.findDayfromList(data.clientIpCountList,this.dayBeforeYesterDay)\n      var dayBeforeYesterDaypvCountData = this.findDayfromList(data.pvCountByHourList,this.dayBeforeYesterDay)\n      var dayBeforeYesterDayipPercentData = this.findDayfromList(data.ipPercentRateList,this.dayBeforeYesterDay)\n      this.theDayBeforeYesterDayadIpCountByHourList = this.generateyAxios(data.adIpCountByHourList,dayBeforeYesterDayAdCountData)\n      this.theDayBeforeYesterDayclientIpCountList = this.generateyAxios(data.clientIpCountList,dayBeforeYesterDayClientIpData)\n      this.theDayBeforeYesterDaypvCountByHourList = this.generateyAxios(data.pvCountByHourList,dayBeforeYesterDaypvCountData)\n      this.theDayBeforeYesteripPercentRateList = this.addPercentForItem(this.generateyAxios(data.ipPercentRateList,dayBeforeYesterDayipPercentData))\n\n    }\n  },\n  dateFtt(fmt, date, monthNum) {\n    var o = {\n      \"M+\": date.getMonth() + monthNum, //月份\n      \"d+\": date.getDate(), //日\n      \"h+\": date.getHours(), //小时\n      \"m+\": date.getMinutes(), //分\n      \"s+\": date.getSeconds(), //秒\n      \"q+\": Math.floor((date.getMonth() + 3) / 3), //季度\n      S: date.getMilliseconds() //毫秒\n    };\n    if (/(y+)/.test(fmt))\n      fmt = fmt.replace(\n        RegExp.$1,\n        (date.getFullYear() + \"\").substr(4 - RegExp.$1.length)\n      );\n    for (var k in o)\n      if (new RegExp(\"(\" + k + \")\").test(fmt))\n        fmt = fmt.replace(\n          RegExp.$1,\n          RegExp.$1.length == 1\n            ? o[k]\n            : (\"00\" + o[k]).substr((\"\" + o[k]).length)\n        );\n    return fmt;\n  },\n  changeAdPosition(val){\n    if(val ===4) {\n      this.backPage = 2;\n      \n    }else{\n      this.backPage =1;\n    }\n  },\n  generateAxios(arr){\n    let result =[]\n    if(this.startDay === this.endDay){\n      result = [\"00\",\"01\",\"02\",\"03\",\"04\",\"05\",\"06\",\"07\",\"08\",\"09\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\"]\n\n    }else {\n      if(!Array.isArray(arr)) return\n      for(let i =0;i<arr.length;i++){\n        result.push(arr[i].date)\n      }\n    }\n    return result\n  },\n  addPercentForItem(arr){\n    let result = []\n    if(!Array.isArray(arr)) return\n    for(let i=0;i<arr.length;i++) {\n      result.push((arr[i]*100).toFixed(2))\n    }\n    return result\n  },\n  findDayfromList(list,str){\n    if(!Array.isArray(list)) return\n      let result = list.find(item=>{\n        return item.date === str\n      })\n    console.log(result)\n      return result\n  },\n  generateyAxios(arr,obj){\n    if(!Array.isArray(arr)) return\n    let result = []\n    if(this.startDay === this.endDay) {\n      for(let item in obj){\n        if(item.indexOf('countHour')>-1){\n          if(obj[item] !==null){\n            result.push(obj[item])\n          }else {\n            result.push(0)\n          }\n          }\n        }\n      }else {\n          for(let i= 0; i<arr.length;i++){\n            result.push(arr[i].total)\n          }\n        }\n    return result\n  },\n   async initChart() {\n      this.chart = echarts.init(document.getElementById(this.id))\n      await this.getData()\n      this.chart.setOption({\n        title: {\n          text:'玉龙资讯数据表',\n          top:20\n        },\n        tooltip: {\n          trigger:'axis',\n          axisPointer: {\n            type:'cross',\n            lineStyle: {\n              color:'#57167B'\n            }\n          }\n        },\n        color:colors,\n        legend: {\n          top:20,\n          icon:'rect',\n          data:[\n            {name:'文章PV',textStyle:{color:colors[0]}},{name:'文章IP',textStyle:colors[1]},{name:'广告点击IP',textStyle:colors[2]},{name:'广告点击率',textStyle:colors[3]},\n            {name:'昨天文章PV',textStyle:colors[0]},{name:'昨天文章IP',textStyle:colors[1]},{name:'昨天广告点击IP',textStyle:colors[2]},{name:'昨天广告点击率',textStyle:colors[3]},\n            {name:'前天文章PV',textStyle:colors[0]},{name:'前天文章IP',textStyle:colors[1]},{name:'前天广告点击IP',textStyle:colors[2]},{name:'前天广告点击率',textStyle:colors[3]}\n          ],\n          // data:['文章PV','文章IP','广告点击IP','广告点击率','昨天文章PV','昨天文章IP','昨天广告点击IP','昨天广告点击率','前天文章PV','前天文章IP','前天广告点击IP','前天广告点击率'],\n          selected:{\n            '昨天文章PV':false,\n            '昨天文章IP':false,\n            '昨天广告点击IP':false,\n            '昨天广告点击率':false,\n            '前天文章PV':false,\n            '前天文章IP':false,\n            '前天广告点击IP':false,\n            '前天广告点击率':false\n          }\n        },\n        grid:{\n          top:100,\n          left: '2%',\n          right: '2%',\n          bottom: '2%',\n          containLabel: true\n        },\n        xAxis: [{\n          type: 'category',\n          boundaryGap: false,\n          axisLine: {\n            lineStyle: {\n              color: '#57617B'\n            }\n          },\n          data: this.axiosData\n        }],\n        yAxis: [{\n          type: 'value',\n          axisTick: {\n            show: false\n          },\n          axisLine: {\n            lineStyle: {\n              color: '#57617B'\n            }\n          },\n          axisLabel: {\n            margin: 10,\n            textStyle: {\n              fontSize: 14\n            }\n          },\n          splitLine: {\n            lineStyle: {\n              color: '#57617B'\n            }\n          }\n        },\n        {\n          type: 'value',\n          name: '广告点击率',\n          min: 0,\n          max: 30,\n          position: 'right',\n          axisLine: {\n              lineStyle: {\n                  color: colors[1]\n              }\n          },\n          axisLabel: {\n              formatter: '{value} %'\n            }\n          }\n        ],\n        series: [\n          {\n              name: '文章PV',\n              type: 'line',\n              symbol: 'circle',\n              symbolSize: 5,\n              smooth:true,\n              showSymbol: false,\n              data: this.pvCountByHourList,\n              lineStyle:{\n                color:colors[0]\n              }\n          },\n          {\n            name: '文章IP',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: 5,\n            smooth:true,\n            showSymbol: false,\n            data: this.clientIpCountList,\n            lineStyle:{\n              color:colors[1]\n            }\n        },\n          {\n            name: '广告点击IP',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: 5,\n            smooth:true,\n            showSymbol: false,\n            data: this.adIpCountByHourList,\n            lineStyle:{\n              color:colors[2]\n            }\n        },\n        {\n            name: '广告点击率',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: 5,\n            smooth:true,\n            yAxisIndex: 1,\n            showSymbol: false,\n            data: this.ipPercentRateList,\n            lineStyle:{\n              color:colors[3]\n            }\n        },\n        {\n              name: '昨天文章PV',\n              type: 'line',\n              symbol: 'circle',\n              symbolSize: 5,\n              smooth:true,\n              showSymbol: false,\n              data: this.yesterDaypvCountByHourList,\n              lineStyle:{\n                color:colors[4]\n              }\n          },\n          {\n            name: '昨天文章IP',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: 5,\n            smooth:true,\n            showSymbol: false,\n            data: this.yesterDayclientIpCountList,\n            lineStyle:{\n              color:colors[5]\n            }\n        },\n          {\n            name: '昨天广告点击IP',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: 5,\n            smooth:true,\n            showSymbol: false,\n            data: this.yesterDayadIpCountByHourList,\n            lineStyle:{\n              color:colors[6]\n            }\n        },\n        {\n            name: '昨天广告点击率',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: 5,\n            yAxisIndex: 1,\n            smooth:true,\n            showSymbol: false,\n            data: this.yesterDayipPercentRateList,\n            lineStyle:{\n              color:colors[7]\n            }\n        },\n        {\n              name: '前天文章PV',\n              type: 'line',\n              symbol: 'circle',\n              symbolSize: 5,\n              smooth:true,\n              showSymbol: false,\n              data: this.theDayBeforeYesterDaypvCountByHourList,\n              lineStyle:{\n                color:colors[8]\n            }\n          },\n          {\n            name: '前天文章IP',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: 5,\n            smooth:true,\n            showSymbol: false,\n            data: this.theDayBeforeYesterDayclientIpCountList,\n            lineStyle:{\n                color:colors[9]\n            }\n        },\n          {\n            name: '前天广告点击IP',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: 5,\n            smooth:true,\n            showSymbol: false,\n            data: this.theDayBeforeYesterDayadIpCountByHourList,\n            lineStyle:{\n                color:colors[10]\n            }\n        },\n        {\n            name: '前天广告点击率',\n            type: 'line',\n            symbol: 'circle',\n            symbolSize: 5,\n            yAxisIndex: 1,\n            smooth:true,\n            showSymbol: false,\n            data: this.theDayBeforeYesteripPercentRateList,\n            lineStyle:{\n                color:colors[11]\n            }\n        }\n        ]\n      })\n    }\n  }\n}\n",{"version":3,"sources":["lineChart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"lineChart.vue","sourceRoot":"src/components/charts","sourcesContent":["<template>\r\n    <div style=\"height:100%\">\r\n        <el-date-picker type=\"date\" size=\"small\" value-format=\"yyyy-MM-dd\" format=\"yyyy-MM-dd\" placeholder=\"开始时间\" v-model=\"startDay\" class=\"handle-label mr10\"></el-date-picker>\r\n        <i class=\"line mr10\">-</i>\r\n        <el-date-picker type=\"date\" size=\"small\" value-format=\"yyyy-MM-dd\" format=\"yyyy-MM-dd\" placeholder=\"结束时间\" v-model=\"endDay\" class=\"handle-label mr10\"></el-date-picker>\r\n        <el-select v-model=\"adposition\" placeholder=\"广告展示位置\" class=\"handle-select mr10\" @change=\"changeAdPosition\">\r\n              <el-option v-for=\"item in adpositionList\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\"></el-option>\r\n          </el-select>\r\n       <el-button type=\"primary\"  @click=\"initChart\">搜索</el-button>\r\n        <div :id=\"id\" :class=\"className\"    :style=\"{height:height,width:width}\"></div>\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\n  import echarts from 'echarts'\r\n  import resize from '../mixins/resize'\r\n  // pv #33b5e5 ip #ffbb33 ad #ff4444 adPercent #9933cc\r\n  var colors = ['#92d0e6','#f3d395','#e09898','#a36dbd','#33b5e5', '#ffbb33', '#ff4444','#9933cc','#0784b3','#f3a307','#e00707','#69049c'];\r\n  var day1 = new Date()\r\n  var day2 = new Date()\r\n  export default {\r\n    mixins:[resize],\r\n    props:{\r\n      className:{\r\n        type:String,\r\n        default:'chart'\r\n      },\r\n      id:{\r\n        type:String,\r\n        default:'chart'\r\n      },\r\n      width:{\r\n        type:String,\r\n        default:'200px'\r\n      },\r\n      height:{\r\n        type:String,\r\n        default:'200px'\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        chart:null,\r\n        startDay:null,\r\n        endDay:null,\r\n        backPage:1,\r\n        adposition:2,\r\n        adTempPosition:2,\r\n        list:[],\r\n        axiosData:[],\r\n        adIpCountByHourList:[],\r\n        clientIpCountList:[],\r\n        pvCountByHourList:[],\r\n        ipPercentRateList:[],\r\n        // 昨天数据\r\n        yesterDayadIpCountByHourList:[],\r\n        yesterDayclientIpCountList:[],\r\n        yesterDaypvCountByHourList:[],\r\n        yesterDayipPercentRateList:[],\r\n        yesterDay:'',\r\n        // 前天数据\r\n        theDayBeforeYesterDayadIpCountByHourList:[],\r\n        theDayBeforeYesterDayclientIpCountList:[],\r\n        theDayBeforeYesterDaypvCountByHourList:[],\r\n        theDayBeforeYesteripPercentRateList:[],\r\n        dayBeforeYesterDay:'',\r\n        adpositionList:[\r\n        {\r\n          value:2,\r\n          label:'底部'\r\n        },\r\n        {\r\n          value:4,\r\n          label:'后退页'\r\n        },\r\n        {\r\n          value:1,\r\n          label:'顶部banner'\r\n        },\r\n        {\r\n          value:3,\r\n          label:'文字链接'\r\n        },\r\n        {\r\n          value:5,\r\n          label:'底部悬浮窗'\r\n        }\r\n      ],\r\n      }\r\n    },\r\n    mounted() {\r\n      this.initChart()\r\n    },\r\n    created(){\r\n      this.startDay = this.dateFtt(\"yyyy-MM-dd\",day1, 1)\r\n      this.endDay = this.dateFtt(\"yyyy-MM-dd\", day1, 1)\r\n    },\r\n    beforeDestroy() {\r\n      if(!this.chart) {\r\n        return\r\n      }\r\n      this.chart.dispose()\r\n      this.chart = null\r\n    },\r\n    methods: {\r\n    async getData() {\r\n      if(this.backPage ===2){\r\n        this.adTempPosition = 2\r\n      }else{\r\n        this.adTempPosition = this.adposition\r\n      }\r\n      let {data:{data,code}} = await this.$axios.get(this.BASE_URL + `admin/account/lineChartByDate?startDay=${this.startDay}&endDay=${this.endDay}&backPage=${this.backPage}&adPosition=${this.adTempPosition}`)\r\n      if(+code ===200){\r\n        this.list = data\r\n        var yesterDayTime = new Date(this.startDay).getTime() - 86400000\r\n        var dayBeforeYesterDayTime = new Date(this.startDay).getTime() - 86400000 * 2\r\n        this.yesterDay= this.dateFtt('yyyy-MM-dd',new Date(yesterDayTime),1)\r\n        this.dayBeforeYesterDay = this.dateFtt('yyyy-MM-dd',new Date(dayBeforeYesterDayTime),1)\r\n        this.axiosData = this.generateAxios(data.adIpCountByHourList)\r\n        // 今日数据\r\n        var todayAdCountData = this.findDayfromList(data.adIpCountByHourList,this.startDay)\r\n        var todayClientIpData = this.findDayfromList(data.clientIpCountList,this.startDay)\r\n        var todaypvCountData = this.findDayfromList(data.pvCountByHourList,this.startDay)\r\n        var todayipPercentData = this.findDayfromList(data.ipPercentRateList,this.startDay)\r\n        this.adIpCountByHourList = this.generateyAxios(data.adIpCountByHourList,todayAdCountData)\r\n        this.clientIpCountList = this.generateyAxios(data.clientIpCountList,todayClientIpData)\r\n        this.pvCountByHourList = this.generateyAxios(data.pvCountByHourList,todaypvCountData)\r\n        this.ipPercentRateList = this.addPercentForItem(this.generateyAxios(data.ipPercentRateList,todayipPercentData))\r\n        \r\n          // 昨日数据\r\n        var yesterDayAdCountData = this.findDayfromList(data.adIpCountByHourList,this.yesterDay)\r\n        var yesterDayClientIpData = this.findDayfromList(data.clientIpCountList,this.yesterDay)\r\n        var yesterDaypvCountData = this.findDayfromList(data.pvCountByHourList,this.yesterDay)\r\n        var yesterDayipPercentData = this.findDayfromList(data.ipPercentRateList,this.yesterDay)\r\n        this.yesterDayadIpCountByHourList = this.generateyAxios(data.adIpCountByHourList,yesterDayAdCountData)\r\n        this.yesterDayclientIpCountList = this.generateyAxios(data.clientIpCountList,yesterDayClientIpData)\r\n        this.yesterDaypvCountByHourList = this.generateyAxios(data.pvCountByHourList,yesterDaypvCountData)\r\n        this.yesterDayipPercentRateList = this.addPercentForItem(this.generateyAxios(data.ipPercentRateList,yesterDayipPercentData))\r\n\r\n          // 前天数据\r\n        var dayBeforeYesterDayAdCountData = this.findDayfromList(data.adIpCountByHourList,this.dayBeforeYesterDay)\r\n        var dayBeforeYesterDayClientIpData = this.findDayfromList(data.clientIpCountList,this.dayBeforeYesterDay)\r\n        var dayBeforeYesterDaypvCountData = this.findDayfromList(data.pvCountByHourList,this.dayBeforeYesterDay)\r\n        var dayBeforeYesterDayipPercentData = this.findDayfromList(data.ipPercentRateList,this.dayBeforeYesterDay)\r\n        this.theDayBeforeYesterDayadIpCountByHourList = this.generateyAxios(data.adIpCountByHourList,dayBeforeYesterDayAdCountData)\r\n        this.theDayBeforeYesterDayclientIpCountList = this.generateyAxios(data.clientIpCountList,dayBeforeYesterDayClientIpData)\r\n        this.theDayBeforeYesterDaypvCountByHourList = this.generateyAxios(data.pvCountByHourList,dayBeforeYesterDaypvCountData)\r\n        this.theDayBeforeYesteripPercentRateList = this.addPercentForItem(this.generateyAxios(data.ipPercentRateList,dayBeforeYesterDayipPercentData))\r\n\r\n      }\r\n    },\r\n    dateFtt(fmt, date, monthNum) {\r\n      var o = {\r\n        \"M+\": date.getMonth() + monthNum, //月份\r\n        \"d+\": date.getDate(), //日\r\n        \"h+\": date.getHours(), //小时\r\n        \"m+\": date.getMinutes(), //分\r\n        \"s+\": date.getSeconds(), //秒\r\n        \"q+\": Math.floor((date.getMonth() + 3) / 3), //季度\r\n        S: date.getMilliseconds() //毫秒\r\n      };\r\n      if (/(y+)/.test(fmt))\r\n        fmt = fmt.replace(\r\n          RegExp.$1,\r\n          (date.getFullYear() + \"\").substr(4 - RegExp.$1.length)\r\n        );\r\n      for (var k in o)\r\n        if (new RegExp(\"(\" + k + \")\").test(fmt))\r\n          fmt = fmt.replace(\r\n            RegExp.$1,\r\n            RegExp.$1.length == 1\r\n              ? o[k]\r\n              : (\"00\" + o[k]).substr((\"\" + o[k]).length)\r\n          );\r\n      return fmt;\r\n    },\r\n    changeAdPosition(val){\r\n      if(val ===4) {\r\n        this.backPage = 2;\r\n        \r\n      }else{\r\n        this.backPage =1;\r\n      }\r\n    },\r\n    generateAxios(arr){\r\n      let result =[]\r\n      if(this.startDay === this.endDay){\r\n        result = [\"00\",\"01\",\"02\",\"03\",\"04\",\"05\",\"06\",\"07\",\"08\",\"09\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\"]\r\n\r\n      }else {\r\n        if(!Array.isArray(arr)) return\r\n        for(let i =0;i<arr.length;i++){\r\n          result.push(arr[i].date)\r\n        }\r\n      }\r\n      return result\r\n    },\r\n    addPercentForItem(arr){\r\n      let result = []\r\n      if(!Array.isArray(arr)) return\r\n      for(let i=0;i<arr.length;i++) {\r\n        result.push((arr[i]*100).toFixed(2))\r\n      }\r\n      return result\r\n    },\r\n    findDayfromList(list,str){\r\n      if(!Array.isArray(list)) return\r\n        let result = list.find(item=>{\r\n          return item.date === str\r\n        })\r\n      console.log(result)\r\n        return result\r\n    },\r\n    generateyAxios(arr,obj){\r\n      if(!Array.isArray(arr)) return\r\n      let result = []\r\n      if(this.startDay === this.endDay) {\r\n        for(let item in obj){\r\n          if(item.indexOf('countHour')>-1){\r\n            if(obj[item] !==null){\r\n              result.push(obj[item])\r\n            }else {\r\n              result.push(0)\r\n            }\r\n            }\r\n          }\r\n        }else {\r\n            for(let i= 0; i<arr.length;i++){\r\n              result.push(arr[i].total)\r\n            }\r\n          }\r\n      return result\r\n    },\r\n     async initChart() {\r\n        this.chart = echarts.init(document.getElementById(this.id))\r\n        await this.getData()\r\n        this.chart.setOption({\r\n          title: {\r\n            text:'玉龙资讯数据表',\r\n            top:20\r\n          },\r\n          tooltip: {\r\n            trigger:'axis',\r\n            axisPointer: {\r\n              type:'cross',\r\n              lineStyle: {\r\n                color:'#57167B'\r\n              }\r\n            }\r\n          },\r\n          color:colors,\r\n          legend: {\r\n            top:20,\r\n            icon:'rect',\r\n            data:[\r\n              {name:'文章PV',textStyle:{color:colors[0]}},{name:'文章IP',textStyle:colors[1]},{name:'广告点击IP',textStyle:colors[2]},{name:'广告点击率',textStyle:colors[3]},\r\n              {name:'昨天文章PV',textStyle:colors[0]},{name:'昨天文章IP',textStyle:colors[1]},{name:'昨天广告点击IP',textStyle:colors[2]},{name:'昨天广告点击率',textStyle:colors[3]},\r\n              {name:'前天文章PV',textStyle:colors[0]},{name:'前天文章IP',textStyle:colors[1]},{name:'前天广告点击IP',textStyle:colors[2]},{name:'前天广告点击率',textStyle:colors[3]}\r\n            ],\r\n            // data:['文章PV','文章IP','广告点击IP','广告点击率','昨天文章PV','昨天文章IP','昨天广告点击IP','昨天广告点击率','前天文章PV','前天文章IP','前天广告点击IP','前天广告点击率'],\r\n            selected:{\r\n              '昨天文章PV':false,\r\n              '昨天文章IP':false,\r\n              '昨天广告点击IP':false,\r\n              '昨天广告点击率':false,\r\n              '前天文章PV':false,\r\n              '前天文章IP':false,\r\n              '前天广告点击IP':false,\r\n              '前天广告点击率':false\r\n            }\r\n          },\r\n          grid:{\r\n            top:100,\r\n            left: '2%',\r\n            right: '2%',\r\n            bottom: '2%',\r\n            containLabel: true\r\n          },\r\n          xAxis: [{\r\n            type: 'category',\r\n            boundaryGap: false,\r\n            axisLine: {\r\n              lineStyle: {\r\n                color: '#57617B'\r\n              }\r\n            },\r\n            data: this.axiosData\r\n          }],\r\n          yAxis: [{\r\n            type: 'value',\r\n            axisTick: {\r\n              show: false\r\n            },\r\n            axisLine: {\r\n              lineStyle: {\r\n                color: '#57617B'\r\n              }\r\n            },\r\n            axisLabel: {\r\n              margin: 10,\r\n              textStyle: {\r\n                fontSize: 14\r\n              }\r\n            },\r\n            splitLine: {\r\n              lineStyle: {\r\n                color: '#57617B'\r\n              }\r\n            }\r\n          },\r\n          {\r\n            type: 'value',\r\n            name: '广告点击率',\r\n            min: 0,\r\n            max: 30,\r\n            position: 'right',\r\n            axisLine: {\r\n                lineStyle: {\r\n                    color: colors[1]\r\n                }\r\n            },\r\n            axisLabel: {\r\n                formatter: '{value} %'\r\n              }\r\n            }\r\n          ],\r\n          series: [\r\n            {\r\n                name: '文章PV',\r\n                type: 'line',\r\n                symbol: 'circle',\r\n                symbolSize: 5,\r\n                smooth:true,\r\n                showSymbol: false,\r\n                data: this.pvCountByHourList,\r\n                lineStyle:{\r\n                  color:colors[0]\r\n                }\r\n            },\r\n            {\r\n              name: '文章IP',\r\n              type: 'line',\r\n              symbol: 'circle',\r\n              symbolSize: 5,\r\n              smooth:true,\r\n              showSymbol: false,\r\n              data: this.clientIpCountList,\r\n              lineStyle:{\r\n                color:colors[1]\r\n              }\r\n          },\r\n            {\r\n              name: '广告点击IP',\r\n              type: 'line',\r\n              symbol: 'circle',\r\n              symbolSize: 5,\r\n              smooth:true,\r\n              showSymbol: false,\r\n              data: this.adIpCountByHourList,\r\n              lineStyle:{\r\n                color:colors[2]\r\n              }\r\n          },\r\n          {\r\n              name: '广告点击率',\r\n              type: 'line',\r\n              symbol: 'circle',\r\n              symbolSize: 5,\r\n              smooth:true,\r\n              yAxisIndex: 1,\r\n              showSymbol: false,\r\n              data: this.ipPercentRateList,\r\n              lineStyle:{\r\n                color:colors[3]\r\n              }\r\n          },\r\n          {\r\n                name: '昨天文章PV',\r\n                type: 'line',\r\n                symbol: 'circle',\r\n                symbolSize: 5,\r\n                smooth:true,\r\n                showSymbol: false,\r\n                data: this.yesterDaypvCountByHourList,\r\n                lineStyle:{\r\n                  color:colors[4]\r\n                }\r\n            },\r\n            {\r\n              name: '昨天文章IP',\r\n              type: 'line',\r\n              symbol: 'circle',\r\n              symbolSize: 5,\r\n              smooth:true,\r\n              showSymbol: false,\r\n              data: this.yesterDayclientIpCountList,\r\n              lineStyle:{\r\n                color:colors[5]\r\n              }\r\n          },\r\n            {\r\n              name: '昨天广告点击IP',\r\n              type: 'line',\r\n              symbol: 'circle',\r\n              symbolSize: 5,\r\n              smooth:true,\r\n              showSymbol: false,\r\n              data: this.yesterDayadIpCountByHourList,\r\n              lineStyle:{\r\n                color:colors[6]\r\n              }\r\n          },\r\n          {\r\n              name: '昨天广告点击率',\r\n              type: 'line',\r\n              symbol: 'circle',\r\n              symbolSize: 5,\r\n              yAxisIndex: 1,\r\n              smooth:true,\r\n              showSymbol: false,\r\n              data: this.yesterDayipPercentRateList,\r\n              lineStyle:{\r\n                color:colors[7]\r\n              }\r\n          },\r\n          {\r\n                name: '前天文章PV',\r\n                type: 'line',\r\n                symbol: 'circle',\r\n                symbolSize: 5,\r\n                smooth:true,\r\n                showSymbol: false,\r\n                data: this.theDayBeforeYesterDaypvCountByHourList,\r\n                lineStyle:{\r\n                  color:colors[8]\r\n              }\r\n            },\r\n            {\r\n              name: '前天文章IP',\r\n              type: 'line',\r\n              symbol: 'circle',\r\n              symbolSize: 5,\r\n              smooth:true,\r\n              showSymbol: false,\r\n              data: this.theDayBeforeYesterDayclientIpCountList,\r\n              lineStyle:{\r\n                  color:colors[9]\r\n              }\r\n          },\r\n            {\r\n              name: '前天广告点击IP',\r\n              type: 'line',\r\n              symbol: 'circle',\r\n              symbolSize: 5,\r\n              smooth:true,\r\n              showSymbol: false,\r\n              data: this.theDayBeforeYesterDayadIpCountByHourList,\r\n              lineStyle:{\r\n                  color:colors[10]\r\n              }\r\n          },\r\n          {\r\n              name: '前天广告点击率',\r\n              type: 'line',\r\n              symbol: 'circle',\r\n              symbolSize: 5,\r\n              yAxisIndex: 1,\r\n              smooth:true,\r\n              showSymbol: false,\r\n              data: this.theDayBeforeYesteripPercentRateList,\r\n              lineStyle:{\r\n                  color:colors[11]\r\n              }\r\n          }\r\n          ]\r\n        })\r\n      }\r\n    }\r\n  }\r\n</script>"]}]}