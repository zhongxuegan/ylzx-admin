{"remainingRequest":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\src\\main\\activity\\set_accept_award.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\src\\main\\activity\\set_accept_award.vue","mtime":1597975847641},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { formatUnit } from '../../utils/index.js';\r\nexport default {\r\n\tname: 'set_accept_award',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\thasC: false,\r\n\t\t\tisEdit: false,\r\n\t\t\tisUpdate: false, //判断是向后端添加还是修改\r\n\t\t\trules: {\r\n\t\t\t\t'config.title': [{ required: true, message: '请输入标题', trigger: 'blur' }],\r\n\t\t\t\tstatus: [{ required: true, message: '请选择状态', trigger: 'blur' }],\r\n\t\t\t\t'multiConfigs.0.awardAmt': [{ required: true, message: '请输入徒弟1提奖励', trigger: 'blur' }]\r\n\t\t\t},\r\n\t\t\tformLabelWidth: '150px',\r\n\t\t\tsetAcceptForm: {\r\n\t\t\t\tconfig: {\r\n\t\t\t\t\tid: null,\r\n\t\t\t\t\tstatus: '0',\r\n\t\t\t\t\tscheme: '',\r\n\t\t\t\t\ttype: '2'\r\n\t\t\t\t},\r\n\t\t\t\tgeneralConfig: {\r\n\t\t\t\t\teffectiveDiscipleDrawMoney: '',\r\n\t\t\t\t\teffectiveDiscipleDrawMoneyAward: ''\r\n\t\t\t\t},\r\n\t\t\t\tmultiConfigs: [\r\n\t\t\t\t\t{ numberValue: 1, awardAmt: '' },\r\n\t\t\t\t\t{ numberValue: 2, awardAmt: '' },\r\n\t\t\t\t\t{ numberValue: 3, awardAmt: '' },\r\n\t\t\t\t\t{ numberValue: 4, awardAmt: '' },\r\n\t\t\t\t\t{ numberValue: 5, awardAmt: '' }\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tkeepForm: {}\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\taddPrenticeAward() {\r\n\t\t\tthis.setAcceptForm.multiConfigs.push({\r\n\t\t\t\tnumberValue: (this.setAcceptForm.multiConfigs.length + 1).toString(),\r\n\t\t\t\tawardAmt: null\r\n\t\t\t});\r\n\t\t},\r\n\t\tremovePrenticeAward() {\r\n\t\t\tif (this.setAcceptForm.multiConfigs.length <= 1) return;\r\n\t\t\tthis.setAcceptForm.multiConfigs.pop();\r\n\t\t},\r\n\t\tcancel(formName) {\r\n\t\t\tthis.$refs[formName].clearValidate();\r\n\t\t\tthis.setAcceptForm = JSON.parse(JSON.stringify(this.keepForm));\r\n\t\t\tthis.isEdit = false;\r\n\t\t},\r\n\t\trest(formName) {\r\n\t\t\tthis.$confirm('确认清空吗？', '提示', {\r\n\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\ttype: 'warning'\r\n\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tthis.$refs[formName].resetFields();\r\n\t\t\t\t\tthis.$refs.content.setContent('');\r\n\t\t\t\t})\r\n\t\t\t\t.catch(() => {});\r\n\t\t},\r\n\t\tasync saveAcceptAward() {\r\n\t\t\tlet postData = JSON.parse(JSON.stringify(this.setAcceptForm));\r\n\t\t\tlet url;\r\n\t\t\t// 元 转 分\r\n\t\t\tpostData = formatUnit(postData);\r\n\t\t\tpostData.config.startTime = this.$moment().format('YYYY-MM-DD HH:mm:ss');\r\n\t\t\tpostData.config.endTime = this.$moment().format('YYYY-MM-DD HH:mm:ss');\r\n\t\t\tif (this.isUpdate) {\r\n\t\t\t\turl = this.BASE_URL + `admin/activity/config/update?id=${postData.config.id}`;\r\n\t\t\t} else {\r\n\t\t\t\turl = this.BASE_URL + 'admin/activity/config';\r\n\t\t\t}\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code, data, message }\r\n\t\t\t} = await this.$axios.post(url, postData);\r\n\t\t\tif (code == '200') {\r\n\t\t\t\tthis.isEdit = false;\r\n\t\t\t\tthis.$message.success(message);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsubmitForm(formName) {\r\n\t\t\tthis.$refs[formName].validate(valid => {\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\tlet msg;\r\n\t\t\t\t\tif (this.isUpdate) {\r\n\t\t\t\t\t\tmsg = '确定修改吗';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmsg = '确定添加吗';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.$confirm(msg, '提示', {\r\n\t\t\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tthis.saveAcceptAward();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch(() => {});\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tasync getData() {\r\n\t\t\tlet params = { type: '2' };\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code, data, message }\r\n\t\t\t} = await this.$axios.get(this.BASE_URL + 'admin/activity/config/type/detail', { params });\r\n\t\t\tif (code == 200) {\r\n\t\t\t\tthis.setAcceptForm = formatUnit(data, true);\r\n\t\t\t\tthis.keepForm = JSON.parse(JSON.stringify(this.setAcceptForm));\r\n\t\t\t\tthis.isUpdate = true; //执行修改\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.isUpdate = false; //执行添加\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\tthis.getData();\r\n\t}\r\n};\r\n",{"version":3,"sources":["set_accept_award.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"set_accept_award.vue","sourceRoot":"src/main/activity","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"crumbs\">\r\n\t\t\t<el-breadcrumb separator=\"/\">\r\n\t\t\t\t<el-breadcrumb-item>\r\n\t\t\t\t\t<i class=\"el-icon-lx-cascades\"></i>\r\n\t\t\t\t\t收徒阶梯奖励\r\n\t\t\t\t</el-breadcrumb-item>\r\n\t\t\t\t<el-breadcrumb-item>收徒阶梯奖励设置</el-breadcrumb-item>\r\n\t\t\t</el-breadcrumb>\r\n\t\t</div>\r\n\t\t<div class=\"container\">\r\n\t\t\t<div class=\"form-box\" style=\"width:800px;margin: auto;\">\r\n\t\t\t\t<el-form :model=\"setAcceptForm\" :label-width=\"formLabelWidth\" :rules=\"rules\" label-position=\"right\" class=\"form--wrap\" ref=\"setAcceptForm\">\r\n\t\t\t\t\t<el-form-item label=\"活动名称\" prop=\"config.title\">\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<el-input class=\"w200\" v-model.number=\"setAcceptForm.config.title\" autocomplete=\"off\"></el-input>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<span>{{ setAcceptForm.config.title }}</span>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item label=\"状态\" prop=\"config.status\">\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<el-switch v-model=\"setAcceptForm.config.status\" active-color=\"#13ce66\" inactive-color=\"#dddddd\" active-value=\"1\" inactive-value=\"0\"></el-switch>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<el-switch\r\n\t\t\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\t\t\tv-model=\"setAcceptForm.config.status\"\r\n\t\t\t\t\t\t\t\tactive-color=\"#13ce66\"\r\n\t\t\t\t\t\t\t\tinactive-color=\"#dddddd\"\r\n\t\t\t\t\t\t\t\tactive-value=\"1\"\r\n\t\t\t\t\t\t\t\tinactive-value=\"0\"\r\n\t\t\t\t\t\t\t></el-switch>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item\r\n\t\t\t\t\t\tv-for=\"(item, index) in setAcceptForm.multiConfigs\"\r\n\t\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t\t:label=\"`徒弟${item.numberValue}提奖励`\"\r\n\t\t\t\t\t\t:prop=\"'multiConfigs.' + index + '.awardAmt'\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<el-input type=\"number\" v-model.number=\"item.awardAmt\">\r\n\t\t\t\t\t\t\t\t<template slot=\"append\">\r\n\t\t\t\t\t\t\t\t\t元\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</el-input>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<span>{{ item.awardAmt + ' 元' }}</span>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item v-if=\"isEdit\">\r\n\t\t\t\t\t\t<el-button @click=\"addPrenticeAward\">新增</el-button>\r\n\t\t\t\t\t\t<el-button @click.prevent=\"removePrenticeAward\">移除</el-button>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item label=\"徒弟提现满额\" prop=\"generalConfig.effectiveDiscipleDrawMoney\">\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<el-input class=\"w200\" type=\"number\" v-model.number=\"setAcceptForm.generalConfig.effectiveDiscipleDrawMoney\" autocomplete=\"off\">\r\n\t\t\t\t\t\t\t\t<template slot=\"append\">\r\n\t\t\t\t\t\t\t\t\t元\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</el-input>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<span>{{ setAcceptForm.generalConfig.effectiveDiscipleDrawMoney + ' 元' }}</span>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item label=\"师父满额奖励\" prop=\"generalConfig.effectiveDiscipleDrawMoneyAward\">\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<el-input class=\"w200\" type=\"number\" v-model.number=\"setAcceptForm.generalConfig.effectiveDiscipleDrawMoneyAward\" autocomplete=\"off\">\r\n\t\t\t\t\t\t\t\t<template slot=\"append\">\r\n\t\t\t\t\t\t\t\t\t元\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</el-input>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<span>{{ setAcceptForm.generalConfig.effectiveDiscipleDrawMoneyAward + ' 元' }}</span>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item label=\"规则\" prop=\"scheme\">\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<div class=\"edit_container\"><tinymce ref=\"content\" :height=\"300\" :childHasChange=\"hasC\" v-model=\"setAcceptForm.config.scheme\" /></div>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<span v-html=\"setAcceptForm.config.scheme\"></span>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<el-button @click=\"cancel('setAcceptForm')\">取 消</el-button>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"submitForm('setAcceptForm')\">确 定</el-button>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"isEdit = true\">修改</el-button>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</el-form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { formatUnit } from '../../utils/index.js';\r\nexport default {\r\n\tname: 'set_accept_award',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\thasC: false,\r\n\t\t\tisEdit: false,\r\n\t\t\tisUpdate: false, //判断是向后端添加还是修改\r\n\t\t\trules: {\r\n\t\t\t\t'config.title': [{ required: true, message: '请输入标题', trigger: 'blur' }],\r\n\t\t\t\tstatus: [{ required: true, message: '请选择状态', trigger: 'blur' }],\r\n\t\t\t\t'multiConfigs.0.awardAmt': [{ required: true, message: '请输入徒弟1提奖励', trigger: 'blur' }]\r\n\t\t\t},\r\n\t\t\tformLabelWidth: '150px',\r\n\t\t\tsetAcceptForm: {\r\n\t\t\t\tconfig: {\r\n\t\t\t\t\tid: null,\r\n\t\t\t\t\tstatus: '0',\r\n\t\t\t\t\tscheme: '',\r\n\t\t\t\t\ttype: '2'\r\n\t\t\t\t},\r\n\t\t\t\tgeneralConfig: {\r\n\t\t\t\t\teffectiveDiscipleDrawMoney: '',\r\n\t\t\t\t\teffectiveDiscipleDrawMoneyAward: ''\r\n\t\t\t\t},\r\n\t\t\t\tmultiConfigs: [\r\n\t\t\t\t\t{ numberValue: 1, awardAmt: '' },\r\n\t\t\t\t\t{ numberValue: 2, awardAmt: '' },\r\n\t\t\t\t\t{ numberValue: 3, awardAmt: '' },\r\n\t\t\t\t\t{ numberValue: 4, awardAmt: '' },\r\n\t\t\t\t\t{ numberValue: 5, awardAmt: '' }\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tkeepForm: {}\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\taddPrenticeAward() {\r\n\t\t\tthis.setAcceptForm.multiConfigs.push({\r\n\t\t\t\tnumberValue: (this.setAcceptForm.multiConfigs.length + 1).toString(),\r\n\t\t\t\tawardAmt: null\r\n\t\t\t});\r\n\t\t},\r\n\t\tremovePrenticeAward() {\r\n\t\t\tif (this.setAcceptForm.multiConfigs.length <= 1) return;\r\n\t\t\tthis.setAcceptForm.multiConfigs.pop();\r\n\t\t},\r\n\t\tcancel(formName) {\r\n\t\t\tthis.$refs[formName].clearValidate();\r\n\t\t\tthis.setAcceptForm = JSON.parse(JSON.stringify(this.keepForm));\r\n\t\t\tthis.isEdit = false;\r\n\t\t},\r\n\t\trest(formName) {\r\n\t\t\tthis.$confirm('确认清空吗？', '提示', {\r\n\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\ttype: 'warning'\r\n\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tthis.$refs[formName].resetFields();\r\n\t\t\t\t\tthis.$refs.content.setContent('');\r\n\t\t\t\t})\r\n\t\t\t\t.catch(() => {});\r\n\t\t},\r\n\t\tasync saveAcceptAward() {\r\n\t\t\tlet postData = JSON.parse(JSON.stringify(this.setAcceptForm));\r\n\t\t\tlet url;\r\n\t\t\t// 元 转 分\r\n\t\t\tpostData = formatUnit(postData);\r\n\t\t\tpostData.config.startTime = this.$moment().format('YYYY-MM-DD HH:mm:ss');\r\n\t\t\tpostData.config.endTime = this.$moment().format('YYYY-MM-DD HH:mm:ss');\r\n\t\t\tif (this.isUpdate) {\r\n\t\t\t\turl = this.BASE_URL + `admin/activity/config/update?id=${postData.config.id}`;\r\n\t\t\t} else {\r\n\t\t\t\turl = this.BASE_URL + 'admin/activity/config';\r\n\t\t\t}\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code, data, message }\r\n\t\t\t} = await this.$axios.post(url, postData);\r\n\t\t\tif (code == '200') {\r\n\t\t\t\tthis.isEdit = false;\r\n\t\t\t\tthis.$message.success(message);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsubmitForm(formName) {\r\n\t\t\tthis.$refs[formName].validate(valid => {\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\tlet msg;\r\n\t\t\t\t\tif (this.isUpdate) {\r\n\t\t\t\t\t\tmsg = '确定修改吗';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmsg = '确定添加吗';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.$confirm(msg, '提示', {\r\n\t\t\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tthis.saveAcceptAward();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch(() => {});\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tasync getData() {\r\n\t\t\tlet params = { type: '2' };\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code, data, message }\r\n\t\t\t} = await this.$axios.get(this.BASE_URL + 'admin/activity/config/type/detail', { params });\r\n\t\t\tif (code == 200) {\r\n\t\t\t\tthis.setAcceptForm = formatUnit(data, true);\r\n\t\t\t\tthis.keepForm = JSON.parse(JSON.stringify(this.setAcceptForm));\r\n\t\t\t\tthis.isUpdate = true; //执行修改\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.isUpdate = false; //执行添加\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\tthis.getData();\r\n\t}\r\n};\r\n</script>"]}]}