{"remainingRequest":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\src\\main\\statistics\\user_data_monitoring.vue?vue&type=style&index=0&id=6e733e78&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\src\\main\\statistics\\user_data_monitoring.vue","mtime":1597905188080},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.handle-box {\r\n\tmargin-bottom: 15px;\r\n}\r\n\r\n.handle-label {\r\n\twidth: 140px;\r\n}\r\n\r\n.handle-select {\r\n\twidth: 120px;\r\n}\r\n\r\n.handle-input {\r\n\twidth: 200px;\r\n\tdisplay: inline-block;\r\n}\r\n.del-dialog-cnt {\r\n\tfont-size: 16px;\r\n\ttext-align: center;\r\n}\r\n.table {\r\n\twidth: 100%;\r\n\tfont-size: 14px;\r\n}\r\n.red {\r\n\tcolor: #ff0000;\r\n}\r\n.mr10 {\r\n\tmargin-right: 10px;\r\n}\r\n",{"version":3,"sources":["user_data_monitoring.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAobA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"user_data_monitoring.vue","sourceRoot":"src/main/statistics","sourcesContent":["<template>\r\n\t<div class=\"table\">\r\n\t\t<div class=\"crumbs\">\r\n\t\t\t<el-breadcrumb separator=\"/\">\r\n\t\t\t\t<el-breadcrumb-item>\r\n\t\t\t\t\t<i class=\"el-icon-lx-cascades\"></i>\r\n\t\t\t\t\t用户数据监测\r\n\t\t\t\t</el-breadcrumb-item>\r\n\t\t\t</el-breadcrumb>\r\n\t\t</div>\r\n\t\t<div class=\"container\">\r\n\t\t\t<div class=\"handle-box\">\r\n\t\t\t\t<el-date-picker\r\n\t\t\t\t\ttype=\"date\"\r\n\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\tvalue-format=\"yyyy-MM-dd\"\r\n\t\t\t\t\tformat=\"yyyy-MM-dd\"\r\n\t\t\t\t\tplaceholder=\"支付时间\"\r\n\t\t\t\t\tv-model=\"startCountDate\"\r\n\t\t\t\t\tclass=\"handle-label mr10\"\r\n\t\t\t\t\t@change=\"startCountDateChange\"\r\n\t\t\t\t></el-date-picker>\r\n\t\t\t\t<i class=\"line mr10\">-</i>\r\n\t\t\t\t<el-date-picker\r\n\t\t\t\t\ttype=\"date\"\r\n\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\tvalue-format=\"yyyy-MM-dd\"\r\n\t\t\t\t\tformat=\"yyyy-MM-dd\"\r\n\t\t\t\t\tplaceholder=\"支付时间\"\r\n\t\t\t\t\tv-model=\"endCountDate\"\r\n\t\t\t\t\tclass=\"handle-label mr10\"\r\n\t\t\t\t\t@change=\"endCountDateChange\"\r\n\t\t\t\t></el-date-picker>\r\n\t\t\t\t<el-select v-model=\"userType\" placeholder=\"用户类型\" class=\"handle-select mr10\" @change=\"changeStatus\">\r\n\t\t\t\t\t<el-option v-for=\"item in userTypeArr\" :key=\"item.value\" :label=\"item.name\" :value=\"item.value\"></el-option>\r\n\t\t\t\t</el-select>\r\n\t\t\t\t<el-input v-model=\"select_word\" placeholder=\"用户ID\" class=\"handle-input mr10\"></el-input>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"search\">搜索</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"exportExcel\">导出</el-button>\r\n\t\t\t</div>\r\n\t\t\t<el-table\r\n\t\t\t\t:data=\"tableData\"\r\n\t\t\t\tv-loading=\"tableLoading\"\r\n\t\t\t\tborder\r\n\t\t\t\tclass=\"table\"\r\n\t\t\t\tref=\"multipleTable\"\r\n\t\t\t\t@selection-change=\"handleSelectionChange\"\r\n\t\t\t\tsize=\"mini\"\r\n\t\t\t\t:cell-style=\"cellStyle\"\r\n\t\t\t\t:row-style=\"rowStyle\"\r\n\t\t\t\tstyle=\"font-size: 10px\">\r\n\t\t\t\t<el-table-column prop=\"userId\" label=\"用户ID\" width=\"60\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"remark\" align=\"center\" label=\"备注\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<el-popover trigger=\"hover\" placement=\"right\">\r\n\t\t\t\t\t\t\t<div style=\"margin-bottom:5px;\">\r\n\t\t\t\t\t\t\t\t<el-input type=\"textarea\" v-model=\"scope.row.remark\" :rows=\"3\" v-if=\"scope.row.editing\"></el-input>\r\n\t\t\t\t\t\t\t\t<p v-else>{{ scope.row.originRemark }}</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<el-button type=\"info\" v-if=\"scope.row.editing\" @click=\"cancelRemark(scope.row, scope.$index)\">取消</el-button>\r\n\t\t\t\t\t\t\t<el-button type=\"info\" v-else @click=\"editRemark(scope.row, scope.$index)\">编辑</el-button>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"saveRemark(scope.row)\">保存</el-button>\r\n\t\t\t\t\t\t\t<div slot=\"reference\" class=\"name-wrapper\">\r\n\t\t\t\t\t\t\t\t<p size=\"medium\">{{ scope.row.originRemark ? scope.row.originRemark : '无' | formatString }}</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</el-popover>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column prop=\"parentId\" label=\"师傅ID\" width=\"60\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"appSystemCode\" label=\"设备类型\" width=\"70\" :formatter=\"formaterVersion\" align=\"center\"></el-table-column>\r\n\t\t\t\t<!-- <el-table-column prop=\"userType\" align=\"center\" :formatter=\"formaterUserType\" label=\"用户类型\"  width=\"100\"></el-table-column> -->\r\n\t\t\t\t<el-table-column prop=\"userStatus\" label=\"状态\" width=\"100\" align=\"center\">\r\n\t\t\t\t\t<template scope=\"scope\">\r\n\t\t\t\t\t\t<el-select v-model=\"scope.row.userStatus\" placeholder=\"请选择\" @change=\"userStatusChange(scope.$index, scope.row)\">\r\n\t\t\t\t\t\t\t<el-option v-for=\"item in userStatusOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\"></el-option>\r\n\t\t\t\t\t\t</el-select>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column prop=\"userId\" label=\"扣量\" align=\"center\" width=\"100\">\r\n\t\t\t\t\t<template scope=\"scope\">\r\n\t\t\t\t\t\t<div v-if=\"scope.row.buckleAmount == 0\"><el-button type=\"danger\" @click=\"enableBuckleAmount(scope.$index, scope.row)\">启用</el-button></div>\r\n\t\t\t\t\t\t<div v-if=\"scope.row.buckleAmount != 0\">\r\n\t\t\t\t\t\t\t<el-input v-model=\"scope.row.buckleAmount\" placeholder=\"请输入内容\" width=\"56\" @blur=\"buckleAmountBlur(scope.$index, scope.row)\"></el-input>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column prop=\"adConverRate\" label=\"广告点击率\" :formatter=\"addPercent\" width=\"80\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"ipPercentRate\" label=\"广告转化率\" :formatter=\"addPercent\" width=\"80\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"adCount\" label=\"广告点击\" width=\"80\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"pvCount\" label=\"文章点击PV\" width=\"100\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"clientIpCount\" label=\"文章点击IP\" width=\"100\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"pvIncome\" label=\"支付点击\" width=\"80\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"incomeClientRate\" label=\"点击支付率\" :formatter=\"addPercent\" width=\"80\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"originCount\" label=\"原文点击\" width=\"80\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"originCountRate\" label=\"原文点击率\" :formatter=\"addPercent\" width=\"80\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"m1Count\" label=\"M1\" width=\"60\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"m2Count\" label=\"M2\" width=\"60\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"m3Count\" label=\"M3\" width=\"60\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"wecharBackRate\" label=\"返回微信率\" :formatter=\"addPercent\" width=\"80\" align=\"center\"></el-table-column>\r\n\t\t\t\t<!-- <el-table-column prop=\"shareCount\" label=\"分享文章量\" width=\"80\" align=\"center\"></el-table-column> -->\r\n\r\n\t\t\t\t<el-table-column prop=\"pvIncomeMoney\" label=\"支付金额\" width=\"80\" align=\"center\"></el-table-column>\r\n\t\t\t\t<el-table-column prop=\"yearMonthDay\" :formatter=\"formatDate\" label=\"统计时间\" align=\"center\"></el-table-column>\r\n\t\t\t</el-table>\r\n\t\t\t<div class=\"pagination\">\r\n\t\t\t\t<el-pagination\r\n\t\t\t\t\tbackground\r\n\t\t\t\t\t@current-change=\"handleCurrentChange\"\r\n\t\t\t\t\t@size-change=\"handleSizeChange\"\r\n\t\t\t\t\t:current-page.sync=\"currentPage\"\r\n\t\t\t\t\tlayout=\"total, sizes, prev, pager, next, jumper\"\r\n\t\t\t\t\t:page-sizes=\"[10, 20, 50, 100]\"\r\n\t\t\t\t\t:page-size=\"cur_size\"\r\n\t\t\t\t\t:total=\"cur_total\"\r\n\t\t\t\t></el-pagination>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\tname: 'basetable',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\ttableLoading: false,\r\n\t\t\tuserType: null,\r\n\t\t\tcurrentPage: 1,\r\n\t\t\ttableData: [], // 表格数据\r\n\t\t\tcur_page: 1, // 当前页号\r\n\t\t\tcur_size: 20,\r\n\t\t\tcur_total: 0, // 总记录数\r\n\t\t\tselect_word: '',\r\n\t\t\tstartCountDate: this.dateFtt('yyyy-MM-dd', new Date(), 1),\r\n\t\t\tendCountDate: this.dateFtt('yyyy-MM-dd', new Date(), 1),\r\n\t\t\tfilename: '',\r\n\t\t\tids: [],\r\n\t\t\texportList: [],\r\n\t\t\trowStyle: { height: '48px' },\r\n\t\t\tcellStyle: { padding: 0 },\r\n\t\t\tuserStatusOptions: [\r\n\t\t\t\t{\r\n\t\t\t\t\t//0:正常 1:封杀\r\n\t\t\t\t\tvalue: 0,\r\n\t\t\t\t\tlabel: '禁用'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tvalue: 1,\r\n\t\t\t\t\tlabel: '正常'\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\tuserTypeArr: [{ name: '全部', value: '' }, { name: '普通用户', value: 1 }, { name: 'vip用户', value: 2 }, { name: 'svip用户', value: 3 }]\r\n\t\t};\r\n\t},\r\n\tfilters: {\r\n\t\tformatString: function(value) {\r\n\t\t\tif (value && value.length > 5) {\r\n\t\t\t\treturn value.substring(0, 5) + '...';\r\n\t\t\t} else {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\tthis.getData();\r\n\t},\r\n\tmethods: {\r\n\t\t// 分页导航\r\n\t\thandleCurrentChange(val) {\r\n\t\t\tthis.currentPage = val;\r\n\t\t\tthis.cur_page = val;\r\n\t\t\tthis.findCountData();\r\n\t\t},\r\n\t\thandleSelectionChange(val) {\r\n\t\t\tthis.multipleSelection = val;\r\n\t\t},\r\n\t\thandleSizeChange(val) {\r\n\t\t\tthis.cur_size = val;\r\n\t\t\tthis.findCountData();\r\n\t\t},\r\n\t\tgetData() {\r\n\t\t\tthis.findCountData();\r\n\t\t},\r\n\t\tformaterVersion(row, column, cellValue, index) {\r\n\t\t\treturn cellValue === 1 ? 'android' : cellValue === 2 ? 'ios' : '未知';\r\n\t\t},\r\n\t\tformatDate(row, column, cellValue, index) {\r\n\t\t\treturn cellValue.substring(4, cellValue.length);\r\n\t\t},\r\n\t\tsearch() {\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.cur_page = 1;\r\n\t\t\tthis.findCountData();\r\n\t\t},\r\n\t\tchangeStatus() {\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.cur_page = 1;\r\n\t\t\tthis.findCountData();\r\n\t\t},\r\n\t\tformaterUserType(row, column, cellValue, index) {\r\n\t\t\treturn cellValue === 1 ? '普通用户' : cellValue === 2 ? 'vip用户' : 'svip用户';\r\n\t\t},\r\n\t\tbuckleAmountBlur(index, row) {\r\n\t\t\tif (row.buckleAmount.indexOf('%') == -1) {\r\n\t\t\t\trow.buckleAmount = row.buckleAmount + '%';\r\n\t\t\t}\r\n\t\t\tthis.$axios\r\n\t\t\t\t.post(this.BASE_URL + 'admin/account/saveBuckleAmount', {\r\n\t\t\t\t\t//保存扣量\r\n\t\t\t\t\tuserId: row.userId,\r\n\t\t\t\t\tbuckleAmount: row.buckleAmount\r\n\t\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\trow.buckleAmount = res.data.data.buckleAmount;\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tenableBuckleAmount(index, row) {\r\n\t\t\trow.buckleAmount = '0%';\r\n\t\t},\r\n\t\taddPercent(row, column, cellValue, index) {\r\n\t\t\treturn cellValue + '%';\r\n\t\t},\r\n\t\toperateList(list) {\r\n\t\t\tif (!Array.isArray(list)) return;\r\n\t\t\tlist.map(item => {\r\n\t\t\t\titem.editing = false;\r\n\t\t\t\titem.originRemark = item.remark;\r\n\t\t\t});\r\n\t\t\treturn list;\r\n\t\t},\r\n\t\tasync findCountData() {\r\n\t\t\tlet postData = {\r\n\t\t\t\tpage: this.cur_page,\r\n\t\t\t\tsize: this.cur_size,\r\n\t\t\t\tstartCountDate: this.startCountDate,\r\n\t\t\t\tendCountDate: this.endCountDate,\r\n\t\t\t\tselectWord: this.select_word,\r\n\t\t\t\tuserType: this.userType\r\n\t\t\t};\r\n\t\t\tlet {\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tdata: { list, total }\r\n\t\t\t\t}\r\n\t\t\t} = await this.$axios.post(this.BASE_URL + 'admin/account/userDataMonitoring', postData);\r\n\t\t\tthis.tableData = this.operateList(list);\r\n\t\t\tthis.cur_total = total;\r\n\t\t\tthis.tableLoading = false;\r\n\t\t},\r\n\t\tuserStatusChange(index, row) {\r\n\t\t\tvar msg = '';\r\n\t\t\tvar confirmButtonText = '';\r\n\t\t\tvar back = 0; //用户取消操作\r\n\t\t\tif (row.userStatus === '') {\r\n\t\t\t\treturn;\r\n\t\t\t} else if (row.userStatus === 0) {\r\n\t\t\t\tmsg = '封杀用户ID为：' + row.userId + ', 是否继续?';\r\n\t\t\t\tconfirmButtonText = '封杀';\r\n\t\t\t\tback = 1;\r\n\t\t\t} else if (row.userStatus === 1) {\r\n\t\t\t\tmsg = '恢复用户ID为：' + row.userId + ', 是否继续?';\r\n\t\t\t\tconfirmButtonText = '启用';\r\n\t\t\t\tback = 0;\r\n\t\t\t}\r\n\t\t\tthis.$confirm(msg, '提示', {\r\n\t\t\t\tconfirmButtonText: confirmButtonText,\r\n\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\ttype: 'warning',\r\n\t\t\t\tcenter: true\r\n\t\t\t}).then(() => {\r\n\t\t\t\tthis.$axios\r\n\t\t\t\t\t.post(this.BASE_URL + 'admin/account/forceOutWecharUser', {\r\n\t\t\t\t\t\t//封杀微信用户\r\n\t\t\t\t\t\tuserId: row.userId,\r\n\t\t\t\t\t\tstatus: row.userStatus\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\trow.userStatus = res.data.data.status;\r\n\t\t\t\t\t});\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\ttype: 'success',\r\n\t\t\t\t\tmessage: confirmButtonText + '成功'\r\n\t\t\t\t});\r\n\t\t\t}).catch(() => {\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\ttype: 'info',\r\n\t\t\t\t\tmessage: '取消' + confirmButtonText\r\n\t\t\t\t});\r\n\t\t\t\trow.userStatus = back;\r\n\t\t\t});\r\n\t\t},\r\n\t\tstartCountDateChange() {\r\n\t\t\tif (this.startCountDate > this.endCountDate) {\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\tmessage: '起始日期不得大于结束日期',\r\n\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t});\r\n\t\t\t\tthis.startCountDate = this.endCountDate;\r\n\t\t\t}\r\n\t\t},\r\n\t\tendCountDateChange() {\r\n\t\t\tif (this.startCountDate > this.endCountDate) {\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\tmessage: '结束日期不得小于起始日期',\r\n\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t});\r\n\t\t\t\tthis.endCountDate = this.startCountDate;\r\n\t\t\t}\r\n\t\t},\r\n\t\t// remark\r\n\t\teditRemark(row) {\r\n\t\t\tthis.tableData.map(item => {\r\n\t\t\t\titem.editing = false;\r\n\t\t\t});\r\n\t\t\trow.editing = true;\r\n\t\t},\r\n\t\t// remark\r\n\t\tcancelRemark(row) {\r\n\t\t\trow.remark = row.originRemark;\r\n\t\t\trow.editing = false;\r\n\t\t},\r\n\t\tsaveRemark(row) {\r\n\t\t\tthis.$axios\r\n\t\t\t\t.post(this.BASE_URL + 'admin/account/forceOutWecharUser', {\r\n\t\t\t\t\tuserId: row.userId,\r\n\t\t\t\t\tstatus: row.userStatus,\r\n\t\t\t\t\tremark: row.remark\r\n\t\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tif (+res.data.code === 200) {\r\n\t\t\t\t\t\tthis.$message.success('保存成功');\r\n\t\t\t\t\t\tthis.getData();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tasync exportExcel() {\r\n\t\t\tawait this.getTop40Data();\r\n\t\t\tthis.getDataByID(this.ids);\r\n\t\t},\r\n\t\t// 导出Excel\r\n\t\tasync getTop40Data() {\r\n\t\t\tlet exportIds = JSON.parse(localStorage.getItem('exportIds')) || [];\r\n\t\t\tvar yesterDayTime = new Date(this.startCountDate).getTime() - 86400000;\r\n\t\t\tthis.yesterDay = this.dateFtt('yyyy-MM-dd', new Date(yesterDayTime), 1);\r\n\t\t\tthis.filename = this.dateFtt('yyyy-MM-dd', new Date(yesterDayTime), 1);\r\n\t\t\tlet postData = {\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tsize: 40,\r\n\t\t\t\tstartCountDate: this.yesterDay,\r\n\t\t\t\tendCountDate: this.yesterDay,\r\n\t\t\t\tselectWord: ''\r\n\t\t\t};\r\n\t\t\tlet {\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tdata: { list }\r\n\t\t\t\t}\r\n\t\t\t} = await this.$axios.post(this.BASE_URL + 'admin/account/userDataMonitoring', postData);\r\n\t\t\tif (!Array.isArray(list)) return;\r\n\t\t\tfor (let i = 0; i < list.length; i++) {\r\n\t\t\t\tthis.ids.push(list[i].userId);\r\n\t\t\t}\r\n\t\t\tthis.ids = Array.from(new Set([...exportIds, ...this.ids]));\r\n\t\t\tlocalStorage.setItem('exportIds', JSON.stringify(this.ids));\r\n\t\t},\r\n\t\tasync getDataByID(ids) {\r\n\t\t\tlet resultArr = [];\r\n\t\t\t// 并发读取远程URL\r\n\t\t\tconst textPromises = ids.map(async id => {\r\n\t\t\t\tlet postData = {\r\n\t\t\t\t\tpage: 1,\r\n\t\t\t\t\tsize: 1,\r\n\t\t\t\t\tstartCountDate: this.yesterDay,\r\n\t\t\t\t\tendCountDate: this.yesterDay,\r\n\t\t\t\t\tselectWord: id\r\n\t\t\t\t};\r\n\t\t\t\tlet {\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tdata: { list }\r\n\t\t\t\t\t}\r\n\t\t\t\t} = await this.$axios.post(this.BASE_URL + 'admin/account/userDataMonitoring', postData);\r\n\t\t\t\treturn list;\r\n\t\t\t});\r\n\t\t\t// 按次序输出\r\n\t\t\tfor (const textPromise of textPromises) {\r\n\t\t\t\tlet res = await textPromise;\r\n\t\t\t\tif (res) {\r\n\t\t\t\t\tresultArr.push(res);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\tthis.exportList = resultArr.flat();\r\n\t\t\tthis.handleDownload();\r\n\t\t},\r\n\t\thandleDownload() {\r\n\t\t\timport('@/vendor/Export2Excel').then(excel => {\r\n\t\t\t\tconst tHeader = ['userId', 'pvCount'];\r\n\t\t\t\tconst filterVal = ['userId', 'pvCount'];\r\n\t\t\t\tconst list = this.exportList;\r\n\t\t\t\tconst data = this.formatJson(filterVal, list);\r\n\t\t\t\tconsole.log(data);return;\r\n\t\t\t\texcel.export_json_to_excel({\r\n\t\t\t\t\theader: tHeader,\r\n\t\t\t\t\tdata,\r\n\t\t\t\t\tfilename: '玉龙资讯' + this.filename,\r\n\t\t\t\t\tautoWidth: true,\r\n\t\t\t\t\tbookType: 'xlsx'\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\t\tformatJson(filterVal, jsonData) {\r\n\t\t\treturn jsonData.map(v =>\r\n\t\t\t\tfilterVal.map(j => {\r\n\t\t\t\t\treturn v[j];\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\t// 公用\r\n\t\tdateFtt(fmt, date, monthNum) {\r\n\t\t\tvar o = {\r\n\t\t\t\t'M+': date.getMonth() + monthNum, //月份\r\n\t\t\t\t'd+': date.getDate(), //日\r\n\t\t\t\t'h+': date.getHours(), //小时\r\n\t\t\t\t'm+': date.getMinutes(), //分\r\n\t\t\t\t's+': date.getSeconds(), //秒\r\n\t\t\t\t'q+': Math.floor((date.getMonth() + 3) / 3), //季度\r\n\t\t\t\tS: date.getMilliseconds() //毫秒\r\n\t\t\t};\r\n\t\t\tif (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (date.getFullYear() + '').substr(4 - RegExp.$1.length));\r\n\t\t\tfor (var k in o) if (new RegExp('(' + k + ')').test(fmt)) fmt = fmt.replace(RegExp.$1, RegExp.$1.length == 1 ? o[k] : ('00' + o[k]).substr(('' + o[k]).length));\r\n\t\t\treturn fmt;\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.handle-box {\r\n\tmargin-bottom: 15px;\r\n}\r\n\r\n.handle-label {\r\n\twidth: 140px;\r\n}\r\n\r\n.handle-select {\r\n\twidth: 120px;\r\n}\r\n\r\n.handle-input {\r\n\twidth: 200px;\r\n\tdisplay: inline-block;\r\n}\r\n.del-dialog-cnt {\r\n\tfont-size: 16px;\r\n\ttext-align: center;\r\n}\r\n.table {\r\n\twidth: 100%;\r\n\tfont-size: 14px;\r\n}\r\n.red {\r\n\tcolor: #ff0000;\r\n}\r\n.mr10 {\r\n\tmargin-right: 10px;\r\n}\r\n</style>\n"]}]}