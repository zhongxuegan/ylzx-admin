{"remainingRequest":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\src\\main\\basic\\time_price.vue?vue&type=style&index=0&id=f70ceb36&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\src\\main\\basic\\time_price.vue","mtime":1597905047168},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.handle-box {\r\n\tpadding-bottom: 15px;\r\n}\r\n.handle-input {\r\n\twidth: 230px;\r\n\tdisplay: inline-block;\r\n}\r\n.mr10 {\r\n\tmargin-right: 10px;\r\n}\r\n.el-input {\r\n\twidth: 200px;\r\n}\r\n.form--wrap .line {\r\n\ttext-align: center;\r\n}\r\n",{"version":3,"sources":["time_price.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2UA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"time_price.vue","sourceRoot":"src/main/basic","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"crumbs\">\r\n\t\t\t<el-breadcrumb separator=\"/\">\r\n\t\t\t\t<el-breadcrumb-item>\r\n\t\t\t\t\t<i class=\"el-icon-lx-cascades\"></i>\r\n\t\t\t\t\t限时提价\r\n\t\t\t\t</el-breadcrumb-item>\r\n\t\t\t</el-breadcrumb>\r\n\t\t</div>\r\n\t\t<div class=\"container\">\r\n\t\t\t<div class=\"handle-box\"><el-button type=\"primary\" icon=\"add\" @click=\"add\">新增</el-button></div>\r\n\t\t\t<el-table v-loading=\"tableLoading\" :span-method=\"objectSpanMethod\" :data=\"dataList\" border row-key=\"id\" class=\"table\">\r\n\t\t\t\t<el-table-column prop=\"startDate\" label=\"日期\" align=\"center\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<span>{{ scope.row.startDate }}</span>\r\n\t\t\t\t\t\t-\r\n\t\t\t\t\t\t<span>{{ scope.row.endDate }}</span>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column align=\"center\" label=\"时段\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<span>{{ scope.row.startInterval }}</span>\r\n\t\t\t\t\t\t-\r\n\t\t\t\t\t\t<span>{{ scope.row.endInterval }}</span>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column align=\"center\" label=\"普通会员 IP收入/IP成本\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<span>{{ scope.row.incomePricePerIP }}</span>\r\n\t\t\t\t\t\t/\r\n\t\t\t\t\t\t<span>{{ scope.row.costPricePerIP }}</span>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column align=\"center\" label=\"VIP IP收入/IP成本\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<span>{{ scope.row.vipIncomePricePerIP }}</span>\r\n\t\t\t\t\t\t/\r\n\t\t\t\t\t\t<span>{{ scope.row.vipCostPricePerIP }}</span>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column label=\"操作\" align=\"center\">\r\n\t\t\t\t\t<template slot-scope=\"scope\">\r\n\t\t\t\t\t\t<el-button type=\"primary\" @click=\"findTime(scope.row.startDate)\">编辑</el-button>\r\n\t\t\t\t\t\t<el-button type=\"primary\" @click=\"confirmDelete(scope.row.startDate)\">删除</el-button>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t</el-table>\r\n\t\t\t<div class=\"pagination\">\r\n\t\t\t\t<el-pagination\r\n\t\t\t\t\tbackground\r\n\t\t\t\t\t@current-change=\"handleCurrentChange\"\r\n\t\t\t\t\t@size-change=\"handleSizeChange\"\r\n\t\t\t\t\tlayout=\"total, sizes, prev, pager, next, jumper\"\r\n\t\t\t\t\t:page-sizes=\"[10, 20, 50, 100]\"\r\n\t\t\t\t\t:current-page.sync=\"currentPage\"\r\n\t\t\t\t\t:total=\"cur_total\"\r\n\t\t\t\t></el-pagination>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<!-- 编辑弹出框 -->\r\n\t\t<el-dialog title=\"新增/编辑\" width=\"60%\" :visible.sync=\"dialogFormVisible\">\r\n\t\t\t<el-form :model=\"dataForm\" :inline=\"true\" :label-width=\"formLabelWidth\" :rules=\"rules\" class=\"form--wrap\" ref=\"dataForm\">\r\n\t\t\t\t<el-row>\r\n\t\t\t\t\t<el-col :span=\"12\">\r\n\t\t\t\t\t\t<el-form-item label=\"开始日期\" prop=\"startDate\" :label-width=\"formLabelWidth\">\r\n\t\t\t\t\t\t\t<el-date-picker v-model=\"dataForm.startDate\" type=\"date\" value-format=\"yyyy-MM-dd\" placeholder=\"选择日期\" @change=\"startDateChange\"></el-date-picker>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</el-col>\r\n\t\t\t\t\t<el-col :span=\"12\">\r\n\t\t\t\t\t\t<el-form-item label=\"结束日期\" prop=\"endDate\" :label-width=\"formLabelWidth\">\r\n\t\t\t\t\t\t\t<el-date-picker v-model=\"dataForm.endDate\" value-format=\"yyyy-MM-dd\" type=\"date\" placeholder=\"选择日期\" @change=\"endDateChange\"></el-date-picker>\r\n\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t</el-col>\r\n\t\t\t\t</el-row>\r\n\t\t\t\t<div style=\"border-top:1px solid #ccc;padding-top:15px;\" v-for=\"(item, index) in dataForm.children\" :key=\"index\">\r\n\t\t\t\t\t<el-row>\r\n\t\t\t\t\t\t<el-col :span=\"12\">\r\n\t\t\t\t\t\t\t<el-form-item label=\"开始时间\" :key=\"index\" :rules=\"[{ required: true, message: '', trigger: 'blur' }]\">\r\n\t\t\t\t\t\t\t\t<el-time-picker v-model=\"item.startInterval\" value-format=\"hh:mm:ss\" placeholder=\"开始时间\"></el-time-picker>\r\n\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t\t<el-col :span=\"12\">\r\n\t\t\t\t\t\t\t<el-form-item label=\"结束时间\" :key=\"index\" :rules=\"[{ required: true, message: '', trigger: 'blur' }]\">\r\n\t\t\t\t\t\t\t\t<el-time-picker v-model=\"item.endInterval\" value-format=\"hh:mm:ss\" placeholder=\"结束时间\"></el-time-picker>\r\n\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t</el-row>\r\n\t\t\t\t\t<el-row>\r\n\t\t\t\t\t\t<el-col :span=\"12\">\r\n\t\t\t\t\t\t\t<el-form-item label=\"普通IP收入\" :key=\"index\"><el-input v-model=\"item.incomePricePerIP\" placeholder=\"普通IP收入\"></el-input></el-form-item>\r\n\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t\t<el-col :span=\"12\">\r\n\t\t\t\t\t\t\t<el-form-item label=\"普通IP成本\" :key=\"index\"><el-input v-model=\"item.costPricePerIP\" placeholder=\"普通IP成本\"></el-input></el-form-item>\r\n\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t</el-row>\r\n\t\t\t\t\t<el-row>\r\n\t\t\t\t\t\t<el-col :span=\"12\">\r\n\t\t\t\t\t\t\t<el-form-item label=\"VIP IP收入\" :key=\"index\"><el-input v-model=\"item.vipIncomePricePerIP\" placeholder=\"VIP IP收入\"></el-input></el-form-item>\r\n\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t\t<el-col :span=\"12\">\r\n\t\t\t\t\t\t\t<el-form-item label=\"VIP IP成本\" :key=\"index\"><el-input v-model=\"item.vipCostPricePerIP\" placeholder=\"VIP IP成本\"></el-input></el-form-item>\r\n\t\t\t\t\t\t</el-col>\r\n\t\t\t\t\t</el-row>\r\n\t\t\t\t</div>\r\n\t\t\t\t<el-form-item>\r\n\t\t\t\t\t<el-button @click.prevent=\"removeTime\" type=\"warning\">删除</el-button>\r\n\t\t\t\t\t<el-button @click.prevent=\"addTime\" type=\"info\">新增</el-button>\r\n\t\t\t\t</el-form-item>\r\n\t\t\t</el-form>\r\n\t\t\t<div slot=\"footer\" class=\"dialog-footer\">\r\n\t\t\t\t<el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n\t\t\t\t<el-button type=\"primary\" @click=\"submitForm('dataForm')\">确 定</el-button>\r\n\t\t\t</div>\r\n\t\t</el-dialog>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\tname: 'elite_club',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tpage: 1,\r\n\t\t\tsize: 10,\r\n\t\t\tcur_total: 0,\r\n\t\t\tcurrentPage: 1,\r\n\t\t\ttableLoading: false,\r\n\t\t\tdialogFormVisible: false,\r\n\t\t\tdataList: [],\r\n\t\t\trule: '',\r\n\t\t\tformLabelWidth: '90px',\r\n\t\t\tdataForm: {\r\n\t\t\t\tstartDate: null,\r\n\t\t\t\tendDate: null,\r\n\t\t\t\tchildren: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstartInterval: '',\r\n\t\t\t\t\t\tendInterval: '',\r\n\t\t\t\t\t\tincomePricePerIP: null,\r\n\t\t\t\t\t\tcostPricePerIP: null,\r\n\t\t\t\t\t\tvipIncomePricePerIP: null,\r\n\t\t\t\t\t\tvipCostPricePerIP: null\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\trules: {\r\n\t\t\t\tstartDate: [{ required: true, message: '开始日期不能为空', trigger: 'change' }],\r\n\t\t\t\tendDate: [{ required: true, message: '结束日期不能为空', trigger: 'change' }]\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\tcreated() {\r\n\t\tthis.getData();\r\n\t},\r\n\tmethods: {\r\n\t\tstartDateChange() {\r\n\t\t\tif (this.dataForm.startDate > this.dataForm.endDate) {\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\tmessage: '开始日期不得大于结束日期',\r\n\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t});\r\n\t\t\t\tthis.dataForm.startDate = this.$moment(this.dataForm.endDate).subtract(1, 'days').format('YYYY-MM-DD');\r\n\t\t\t}\r\n\t\t},\r\n\t\tendDateChange() {\r\n\t\t\tif (this.dataForm.startDate > this.dataForm.endDate) {\r\n\t\t\t\tthis.$message({\r\n\t\t\t\t\tmessage: '结束日期不得小于开始日期',\r\n\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t});\r\n\t\t\t\tthis.dataForm.endDate = this.$moment(this.dataForm.startDate).add(1, 'days').format('YYYY-MM-DD')\r\n\t\t\t}\r\n\t\t},\r\n\t\thandleCurrentChange(val) {\r\n\t\t\tthis.page = val;\r\n\t\t\tthis.currentPage = val;\r\n\t\t\tthis.getData();\r\n\t\t},\r\n\t\thandleSizeChange(val) {\r\n\t\t\tthis.page = 1;\r\n\t\t\tthis.currentPage = 1;\r\n\t\t\tthis.size = val;\r\n\t\t\tthis.getData();\r\n\t\t},\r\n\r\n\t\tasync findTime(time) {\r\n\t\t\tlet {\r\n\t\t\t\tdata: { data }\r\n\t\t\t} = await this.$axios.post(this.BASE_URL + `admin/timePrice/findTimePriceByDate?startDate=${time}`);\r\n\t\t\tthis.dataForm = Object.assign(data);\r\n\t\t\tthis.dialogFormVisible = true;\r\n\t\t},\r\n\r\n\t\tadd() {\r\n\t\t\tthis.$router.push('/time_price_add');\r\n\t\t},\r\n\t\teditActivity(data) {\r\n\t\t\tthis.findTime();\r\n\t\t},\r\n\t\tsaveAward() {\r\n\t\t\tlet postData = this.dataForm;\r\n\t\t\tthis.$axios\r\n\t\t\t\t.post(this.BASE_URL + `admin/timePrice/saveTimePrice?startDate=${this.dataForm.startDate}&endDate=${this.dataForm.endDate}`, this.dataForm.children)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tif (res.data.code === '200') {\r\n\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\tmessage: '保存成功',\r\n\t\t\t\t\t\t\ttype: 'success'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.getData();\r\n\t\t\t\t\t\tthis.$refs['dataForm'].resetFields();\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tthis.dialogFormVisible = false;\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\t\tmessage: '保存失败',\r\n\t\t\t\t\t\t\ttype: 'error'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tsubmitForm(formName) {\r\n\t\t\tthis.$refs[formName].validate(valid => {\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\tthis.saveAward();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tconfirmDelete(time) {\r\n\t\t\tthis.$confirm('此操作将永久删除, 是否继续?', '提示', {\r\n\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\ttype: 'warning'\r\n\t\t\t})\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tthis.deleteTime(time);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(() => {\r\n\t\t\t\t\tthis.$message({\r\n\t\t\t\t\t\ttype: 'info',\r\n\t\t\t\t\t\tmessage: '已取消删除'\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t},\r\n\r\n\t\tasync deleteTime(time) {\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code }\r\n\t\t\t} = await this.$axios.post(this.BASE_URL + `admin/timePrice/deleteTimePrice?startDate=${time}`);\r\n\t\t\tif (+code === 200) {\r\n\t\t\t\tthis.$message.success({\r\n\t\t\t\t\tmessage: '删除成功'\r\n\t\t\t\t});\r\n\t\t\t\tthis.getData();\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync getData() {\r\n\t\t\tlet { page, size } = this;\r\n\t\t\tthis.tableLoading = true;\r\n\t\t\tlet {\r\n\t\t\t\tdata: { data }\r\n\t\t\t} = await this.$axios.post(this.BASE_URL + `admin/timePrice/listTimePrice?page=${page}&size=${size}`);\r\n\t\t\tthis.dataList = this.operateList(data.list);\r\n\t\t\tthis.tableLoading = false;\r\n\t\t\tthis.cur_total = data.total;\r\n\t\t},\r\n\t\toperateList(list) {\r\n\t\t\tif (!Array.isArray(list)) return;\r\n\t\t\tlet arr = [];\r\n\t\t\tif (!Array.isArray(list)) return;\r\n\t\t\tfor (let i = 0; i < list.length; i++) {\r\n\t\t\t\tfor (let j = 0; j < list[i].children.length; j++) {\r\n\t\t\t\t\tarr.push({\r\n\t\t\t\t\t\tnum: j === 0 ? list[i].children.length : null,\r\n\t\t\t\t\t\tstartDate: list[i].startDate,\r\n\t\t\t\t\t\tendDate: list[i].endDate,\r\n\t\t\t\t\t\tstartInterval: list[i].children[j].startInterval,\r\n\t\t\t\t\t\tendInterval: list[i].children[j].endInterval,\r\n\t\t\t\t\t\tincomePricePerIP: list[i].children[j].incomePricePerIP,\r\n\t\t\t\t\t\tcostPricePerIP: list[i].children[j].costPricePerIP,\r\n\t\t\t\t\t\tvipCostPricePerIP: list[i].children[j].vipCostPricePerIP,\r\n\t\t\t\t\t\tvipIncomePricePerIP: list[i].children[j].vipIncomePricePerIP\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn arr;\r\n\t\t},\r\n\r\n\t\taddTime() {\r\n\t\t\tthis.dataForm.children.push({\r\n\t\t\t\tstartInterval: null,\r\n\t\t\t\tendInterval: null,\r\n\t\t\t\tincomePricePerIP: null,\r\n\t\t\t\tcostPricePerIP: null,\r\n\t\t\t\tvipIncomePricePerIP: null,\r\n\t\t\t\tvipCostPricePerIP: null\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tremoveTime(item) {\r\n\t\t\t// var index = this.dataForm.children.indexOf(item);\r\n\t\t\t// if (index !== -1) {\r\n\t\t\t//   this.dataForm.children.splice(index, 1);\r\n\t\t\t// }\r\n\t\t\tif (this.dataForm.children.length <= 1) return;\r\n\t\t\tthis.dataForm.children.pop();\r\n\t\t},\r\n\r\n\t\tobjectSpanMethod({ row, column, rowIndex, columnIndex }) {\r\n\t\t\tif (columnIndex === 0) {\r\n\t\t\t\tif (row.num && rowIndex % row.num === 0) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\trowspan: row.num,\r\n\t\t\t\t\t\tcolspan: 1\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\trowspan: 0,\r\n\t\t\t\t\t\tcolspan: 0\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n</script>\r\n<style scoped>\r\n.handle-box {\r\n\tpadding-bottom: 15px;\r\n}\r\n.handle-input {\r\n\twidth: 230px;\r\n\tdisplay: inline-block;\r\n}\r\n.mr10 {\r\n\tmargin-right: 10px;\r\n}\r\n.el-input {\r\n\twidth: 200px;\r\n}\r\n.form--wrap .line {\r\n\ttext-align: center;\r\n}\r\n</style>\n"]}]}