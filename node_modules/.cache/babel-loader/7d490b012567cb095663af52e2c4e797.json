{"remainingRequest":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\src\\main\\activity\\set_accept_award.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\src\\main\\activity\\set_accept_award.vue","mtime":1597975847641},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\钟学刚\\Desktop\\jfzx-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\\\u949F\\u5B66\\u521A\\\\Desktop\\\\jfzx-admin\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _JSON$stringify from \"C:\\\\Users\\\\\\u949F\\u5B66\\u521A\\\\Desktop\\\\jfzx-admin\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/json/stringify\";\nimport \"core-js/modules/es6.regexp.to-string\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { formatUnit } from '../../utils/index.js';\nexport default {\n  name: 'set_accept_award',\n  data: function data() {\n    return {\n      hasC: false,\n      isEdit: false,\n      isUpdate: false,\n      //判断是向后端添加还是修改\n      rules: {\n        'config.title': [{\n          required: true,\n          message: '请输入标题',\n          trigger: 'blur'\n        }],\n        status: [{\n          required: true,\n          message: '请选择状态',\n          trigger: 'blur'\n        }],\n        'multiConfigs.0.awardAmt': [{\n          required: true,\n          message: '请输入徒弟1提奖励',\n          trigger: 'blur'\n        }]\n      },\n      formLabelWidth: '150px',\n      setAcceptForm: {\n        config: {\n          id: null,\n          status: '0',\n          scheme: '',\n          type: '2'\n        },\n        generalConfig: {\n          effectiveDiscipleDrawMoney: '',\n          effectiveDiscipleDrawMoneyAward: ''\n        },\n        multiConfigs: [{\n          numberValue: 1,\n          awardAmt: ''\n        }, {\n          numberValue: 2,\n          awardAmt: ''\n        }, {\n          numberValue: 3,\n          awardAmt: ''\n        }, {\n          numberValue: 4,\n          awardAmt: ''\n        }, {\n          numberValue: 5,\n          awardAmt: ''\n        }]\n      },\n      keepForm: {}\n    };\n  },\n  methods: {\n    addPrenticeAward: function addPrenticeAward() {\n      this.setAcceptForm.multiConfigs.push({\n        numberValue: (this.setAcceptForm.multiConfigs.length + 1).toString(),\n        awardAmt: null\n      });\n    },\n    removePrenticeAward: function removePrenticeAward() {\n      if (this.setAcceptForm.multiConfigs.length <= 1) return;\n      this.setAcceptForm.multiConfigs.pop();\n    },\n    cancel: function cancel(formName) {\n      this.$refs[formName].clearValidate();\n      this.setAcceptForm = JSON.parse(_JSON$stringify(this.keepForm));\n      this.isEdit = false;\n    },\n    rest: function rest(formName) {\n      var _this = this;\n\n      this.$confirm('确认清空吗？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function (res) {\n        _this.$refs[formName].resetFields();\n\n        _this.$refs.content.setContent('');\n      }).catch(function () {});\n    },\n    saveAcceptAward: function () {\n      var _saveAcceptAward = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var postData, url, _ref, _ref$data, code, data, message;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                postData = JSON.parse(_JSON$stringify(this.setAcceptForm));\n                // 元 转 分\n                postData = formatUnit(postData);\n                postData.config.startTime = this.$moment().format('YYYY-MM-DD HH:mm:ss');\n                postData.config.endTime = this.$moment().format('YYYY-MM-DD HH:mm:ss');\n\n                if (this.isUpdate) {\n                  url = this.BASE_URL + \"admin/activity/config/update?id=\".concat(postData.config.id);\n                } else {\n                  url = this.BASE_URL + 'admin/activity/config';\n                }\n\n                _context.next = 7;\n                return this.$axios.post(url, postData);\n\n              case 7:\n                _ref = _context.sent;\n                _ref$data = _ref.data;\n                code = _ref$data.code;\n                data = _ref$data.data;\n                message = _ref$data.message;\n\n                if (code == '200') {\n                  this.isEdit = false;\n                  this.$message.success(message);\n                }\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function saveAcceptAward() {\n        return _saveAcceptAward.apply(this, arguments);\n      }\n\n      return saveAcceptAward;\n    }(),\n    submitForm: function submitForm(formName) {\n      var _this2 = this;\n\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          var msg;\n\n          if (_this2.isUpdate) {\n            msg = '确定修改吗';\n          } else {\n            msg = '确定添加吗';\n          }\n\n          _this2.$confirm(msg, '提示', {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning'\n          }).then(function () {\n            _this2.saveAcceptAward();\n          }).catch(function () {});\n        } else {\n          return false;\n        }\n      });\n    },\n    getData: function () {\n      var _getData = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var params, _ref2, _ref2$data, code, data, message;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                params = {\n                  type: '2'\n                };\n                _context2.next = 3;\n                return this.$axios.get(this.BASE_URL + 'admin/activity/config/type/detail', {\n                  params: params\n                });\n\n              case 3:\n                _ref2 = _context2.sent;\n                _ref2$data = _ref2.data;\n                code = _ref2$data.code;\n                data = _ref2$data.data;\n                message = _ref2$data.message;\n\n                if (!(code == 200)) {\n                  _context2.next = 13;\n                  break;\n                }\n\n                this.setAcceptForm = formatUnit(data, true);\n                this.keepForm = JSON.parse(_JSON$stringify(this.setAcceptForm));\n                this.isUpdate = true; //执行修改\n\n                return _context2.abrupt(\"return\");\n\n              case 13:\n                this.isUpdate = false; //执行添加\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getData() {\n        return _getData.apply(this, arguments);\n      }\n\n      return getData;\n    }()\n  },\n  created: function created() {\n    this.getData();\n  }\n};",{"version":3,"sources":["set_accept_award.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0GA,SAAA,UAAA,QAAA,sBAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,kBADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,IAAA,EAAA,KADA;AAEA,MAAA,MAAA,EAAA,KAFA;AAGA,MAAA,QAAA,EAAA,KAHA;AAGA;AACA,MAAA,KAAA,EAAA;AACA,wBAAA,CAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,OAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAAA,CADA;AAEA,QAAA,MAAA,EAAA,CAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,OAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAAA,CAFA;AAGA,mCAAA,CAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA,WAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAAA;AAHA,OAJA;AASA,MAAA,cAAA,EAAA,OATA;AAUA,MAAA,aAAA,EAAA;AACA,QAAA,MAAA,EAAA;AACA,UAAA,EAAA,EAAA,IADA;AAEA,UAAA,MAAA,EAAA,GAFA;AAGA,UAAA,MAAA,EAAA,EAHA;AAIA,UAAA,IAAA,EAAA;AAJA,SADA;AAOA,QAAA,aAAA,EAAA;AACA,UAAA,0BAAA,EAAA,EADA;AAEA,UAAA,+BAAA,EAAA;AAFA,SAPA;AAWA,QAAA,YAAA,EAAA,CACA;AAAA,UAAA,WAAA,EAAA,CAAA;AAAA,UAAA,QAAA,EAAA;AAAA,SADA,EAEA;AAAA,UAAA,WAAA,EAAA,CAAA;AAAA,UAAA,QAAA,EAAA;AAAA,SAFA,EAGA;AAAA,UAAA,WAAA,EAAA,CAAA;AAAA,UAAA,QAAA,EAAA;AAAA,SAHA,EAIA;AAAA,UAAA,WAAA,EAAA,CAAA;AAAA,UAAA,QAAA,EAAA;AAAA,SAJA,EAKA;AAAA,UAAA,WAAA,EAAA,CAAA;AAAA,UAAA,QAAA,EAAA;AAAA,SALA;AAXA,OAVA;AA6BA,MAAA,QAAA,EAAA;AA7BA,KAAA;AA+BA,GAlCA;AAmCA,EAAA,OAAA,EAAA;AACA,IAAA,gBADA,8BACA;AACA,WAAA,aAAA,CAAA,YAAA,CAAA,IAAA,CAAA;AACA,QAAA,WAAA,EAAA,CAAA,KAAA,aAAA,CAAA,YAAA,CAAA,MAAA,GAAA,CAAA,EAAA,QAAA,EADA;AAEA,QAAA,QAAA,EAAA;AAFA,OAAA;AAIA,KANA;AAOA,IAAA,mBAPA,iCAOA;AACA,UAAA,KAAA,aAAA,CAAA,YAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,WAAA,aAAA,CAAA,YAAA,CAAA,GAAA;AACA,KAVA;AAWA,IAAA,MAXA,kBAWA,QAXA,EAWA;AACA,WAAA,KAAA,CAAA,QAAA,EAAA,aAAA;AACA,WAAA,aAAA,GAAA,IAAA,CAAA,KAAA,CAAA,gBAAA,KAAA,QAAA,CAAA,CAAA;AACA,WAAA,MAAA,GAAA,KAAA;AACA,KAfA;AAgBA,IAAA,IAhBA,gBAgBA,QAhBA,EAgBA;AAAA;;AACA,WAAA,QAAA,CAAA,QAAA,EAAA,IAAA,EAAA;AACA,QAAA,iBAAA,EAAA,IADA;AAEA,QAAA,gBAAA,EAAA,IAFA;AAGA,QAAA,IAAA,EAAA;AAHA,OAAA,EAKA,IALA,CAKA,UAAA,GAAA,EAAA;AACA,QAAA,KAAA,CAAA,KAAA,CAAA,QAAA,EAAA,WAAA;;AACA,QAAA,KAAA,CAAA,KAAA,CAAA,OAAA,CAAA,UAAA,CAAA,EAAA;AACA,OARA,EASA,KATA,CASA,YAAA,CAAA,CATA;AAUA,KA3BA;AA4BA,IAAA,eA5BA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AA6BA,gBAAA,QA7BA,GA6BA,IAAA,CAAA,KAAA,CAAA,gBAAA,KAAA,aAAA,CAAA,CA7BA;AA+BA;AACA,gBAAA,QAAA,GAAA,UAAA,CAAA,QAAA,CAAA;AACA,gBAAA,QAAA,CAAA,MAAA,CAAA,SAAA,GAAA,KAAA,OAAA,GAAA,MAAA,CAAA,qBAAA,CAAA;AACA,gBAAA,QAAA,CAAA,MAAA,CAAA,OAAA,GAAA,KAAA,OAAA,GAAA,MAAA,CAAA,qBAAA,CAAA;;AACA,oBAAA,KAAA,QAAA,EAAA;AACA,kBAAA,GAAA,GAAA,KAAA,QAAA,6CAAA,QAAA,CAAA,MAAA,CAAA,EAAA,CAAA;AACA,iBAFA,MAEA;AACA,kBAAA,GAAA,GAAA,KAAA,QAAA,GAAA,uBAAA;AACA;;AAvCA;AAAA,uBA0CA,KAAA,MAAA,CAAA,IAAA,CAAA,GAAA,EAAA,QAAA,CA1CA;;AAAA;AAAA;AAAA,iCAyCA,IAzCA;AAyCA,gBAAA,IAzCA,aAyCA,IAzCA;AAyCA,gBAAA,IAzCA,aAyCA,IAzCA;AAyCA,gBAAA,OAzCA,aAyCA,OAzCA;;AA2CA,oBAAA,IAAA,IAAA,KAAA,EAAA;AACA,uBAAA,MAAA,GAAA,KAAA;AACA,uBAAA,QAAA,CAAA,OAAA,CAAA,OAAA;AACA;;AA9CA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAgDA,IAAA,UAhDA,sBAgDA,QAhDA,EAgDA;AAAA;;AACA,WAAA,KAAA,CAAA,QAAA,EAAA,QAAA,CAAA,UAAA,KAAA,EAAA;AACA,YAAA,KAAA,EAAA;AACA,cAAA,GAAA;;AACA,cAAA,MAAA,CAAA,QAAA,EAAA;AACA,YAAA,GAAA,GAAA,OAAA;AACA,WAFA,MAEA;AACA,YAAA,GAAA,GAAA,OAAA;AACA;;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,GAAA,EAAA,IAAA,EAAA;AACA,YAAA,iBAAA,EAAA,IADA;AAEA,YAAA,gBAAA,EAAA,IAFA;AAGA,YAAA,IAAA,EAAA;AAHA,WAAA,EAKA,IALA,CAKA,YAAA;AACA,YAAA,MAAA,CAAA,eAAA;AACA,WAPA,EAQA,KARA,CAQA,YAAA,CAAA,CARA;AASA,SAhBA,MAgBA;AACA,iBAAA,KAAA;AACA;AACA,OApBA;AAqBA,KAtEA;AAuEA,IAAA,OAvEA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAwEA,gBAAA,MAxEA,GAwEA;AAAA,kBAAA,IAAA,EAAA;AAAA,iBAxEA;AAAA;AAAA,uBA2EA,KAAA,MAAA,CAAA,GAAA,CAAA,KAAA,QAAA,GAAA,mCAAA,EAAA;AAAA,kBAAA,MAAA,EAAA;AAAA,iBAAA,CA3EA;;AAAA;AAAA;AAAA,mCA0EA,IA1EA;AA0EA,gBAAA,IA1EA,cA0EA,IA1EA;AA0EA,gBAAA,IA1EA,cA0EA,IA1EA;AA0EA,gBAAA,OA1EA,cA0EA,OA1EA;;AAAA,sBA4EA,IAAA,IAAA,GA5EA;AAAA;AAAA;AAAA;;AA6EA,qBAAA,aAAA,GAAA,UAAA,CAAA,IAAA,EAAA,IAAA,CAAA;AACA,qBAAA,QAAA,GAAA,IAAA,CAAA,KAAA,CAAA,gBAAA,KAAA,aAAA,CAAA,CAAA;AACA,qBAAA,QAAA,GAAA,IAAA,CA/EA,CA+EA;;AA/EA;;AAAA;AAkFA,qBAAA,QAAA,GAAA,KAAA,CAlFA,CAkFA;;AAlFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,GAnCA;AAwHA,EAAA,OAxHA,qBAwHA;AACA,SAAA,OAAA;AACA;AA1HA,CAAA","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"crumbs\">\r\n\t\t\t<el-breadcrumb separator=\"/\">\r\n\t\t\t\t<el-breadcrumb-item>\r\n\t\t\t\t\t<i class=\"el-icon-lx-cascades\"></i>\r\n\t\t\t\t\t收徒阶梯奖励\r\n\t\t\t\t</el-breadcrumb-item>\r\n\t\t\t\t<el-breadcrumb-item>收徒阶梯奖励设置</el-breadcrumb-item>\r\n\t\t\t</el-breadcrumb>\r\n\t\t</div>\r\n\t\t<div class=\"container\">\r\n\t\t\t<div class=\"form-box\" style=\"width:800px;margin: auto;\">\r\n\t\t\t\t<el-form :model=\"setAcceptForm\" :label-width=\"formLabelWidth\" :rules=\"rules\" label-position=\"right\" class=\"form--wrap\" ref=\"setAcceptForm\">\r\n\t\t\t\t\t<el-form-item label=\"活动名称\" prop=\"config.title\">\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<el-input class=\"w200\" v-model.number=\"setAcceptForm.config.title\" autocomplete=\"off\"></el-input>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<span>{{ setAcceptForm.config.title }}</span>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item label=\"状态\" prop=\"config.status\">\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<el-switch v-model=\"setAcceptForm.config.status\" active-color=\"#13ce66\" inactive-color=\"#dddddd\" active-value=\"1\" inactive-value=\"0\"></el-switch>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<el-switch\r\n\t\t\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\t\t\tv-model=\"setAcceptForm.config.status\"\r\n\t\t\t\t\t\t\t\tactive-color=\"#13ce66\"\r\n\t\t\t\t\t\t\t\tinactive-color=\"#dddddd\"\r\n\t\t\t\t\t\t\t\tactive-value=\"1\"\r\n\t\t\t\t\t\t\t\tinactive-value=\"0\"\r\n\t\t\t\t\t\t\t></el-switch>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item\r\n\t\t\t\t\t\tv-for=\"(item, index) in setAcceptForm.multiConfigs\"\r\n\t\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t\t:label=\"`徒弟${item.numberValue}提奖励`\"\r\n\t\t\t\t\t\t:prop=\"'multiConfigs.' + index + '.awardAmt'\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<el-input type=\"number\" v-model.number=\"item.awardAmt\">\r\n\t\t\t\t\t\t\t\t<template slot=\"append\">\r\n\t\t\t\t\t\t\t\t\t元\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</el-input>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<span>{{ item.awardAmt + ' 元' }}</span>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item v-if=\"isEdit\">\r\n\t\t\t\t\t\t<el-button @click=\"addPrenticeAward\">新增</el-button>\r\n\t\t\t\t\t\t<el-button @click.prevent=\"removePrenticeAward\">移除</el-button>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item label=\"徒弟提现满额\" prop=\"generalConfig.effectiveDiscipleDrawMoney\">\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<el-input class=\"w200\" type=\"number\" v-model.number=\"setAcceptForm.generalConfig.effectiveDiscipleDrawMoney\" autocomplete=\"off\">\r\n\t\t\t\t\t\t\t\t<template slot=\"append\">\r\n\t\t\t\t\t\t\t\t\t元\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</el-input>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<span>{{ setAcceptForm.generalConfig.effectiveDiscipleDrawMoney + ' 元' }}</span>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item label=\"师父满额奖励\" prop=\"generalConfig.effectiveDiscipleDrawMoneyAward\">\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<el-input class=\"w200\" type=\"number\" v-model.number=\"setAcceptForm.generalConfig.effectiveDiscipleDrawMoneyAward\" autocomplete=\"off\">\r\n\t\t\t\t\t\t\t\t<template slot=\"append\">\r\n\t\t\t\t\t\t\t\t\t元\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</el-input>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<span>{{ setAcceptForm.generalConfig.effectiveDiscipleDrawMoneyAward + ' 元' }}</span>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item label=\"规则\" prop=\"scheme\">\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<div class=\"edit_container\"><tinymce ref=\"content\" :height=\"300\" :childHasChange=\"hasC\" v-model=\"setAcceptForm.config.scheme\" /></div>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<span v-html=\"setAcceptForm.config.scheme\"></span>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t<template v-if=\"isEdit\">\r\n\t\t\t\t\t\t\t<el-button @click=\"cancel('setAcceptForm')\">取 消</el-button>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"submitForm('setAcceptForm')\">确 定</el-button>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"isEdit = true\">修改</el-button>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</el-form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { formatUnit } from '../../utils/index.js';\r\nexport default {\r\n\tname: 'set_accept_award',\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\thasC: false,\r\n\t\t\tisEdit: false,\r\n\t\t\tisUpdate: false, //判断是向后端添加还是修改\r\n\t\t\trules: {\r\n\t\t\t\t'config.title': [{ required: true, message: '请输入标题', trigger: 'blur' }],\r\n\t\t\t\tstatus: [{ required: true, message: '请选择状态', trigger: 'blur' }],\r\n\t\t\t\t'multiConfigs.0.awardAmt': [{ required: true, message: '请输入徒弟1提奖励', trigger: 'blur' }]\r\n\t\t\t},\r\n\t\t\tformLabelWidth: '150px',\r\n\t\t\tsetAcceptForm: {\r\n\t\t\t\tconfig: {\r\n\t\t\t\t\tid: null,\r\n\t\t\t\t\tstatus: '0',\r\n\t\t\t\t\tscheme: '',\r\n\t\t\t\t\ttype: '2'\r\n\t\t\t\t},\r\n\t\t\t\tgeneralConfig: {\r\n\t\t\t\t\teffectiveDiscipleDrawMoney: '',\r\n\t\t\t\t\teffectiveDiscipleDrawMoneyAward: ''\r\n\t\t\t\t},\r\n\t\t\t\tmultiConfigs: [\r\n\t\t\t\t\t{ numberValue: 1, awardAmt: '' },\r\n\t\t\t\t\t{ numberValue: 2, awardAmt: '' },\r\n\t\t\t\t\t{ numberValue: 3, awardAmt: '' },\r\n\t\t\t\t\t{ numberValue: 4, awardAmt: '' },\r\n\t\t\t\t\t{ numberValue: 5, awardAmt: '' }\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tkeepForm: {}\r\n\t\t};\r\n\t},\r\n\tmethods: {\r\n\t\taddPrenticeAward() {\r\n\t\t\tthis.setAcceptForm.multiConfigs.push({\r\n\t\t\t\tnumberValue: (this.setAcceptForm.multiConfigs.length + 1).toString(),\r\n\t\t\t\tawardAmt: null\r\n\t\t\t});\r\n\t\t},\r\n\t\tremovePrenticeAward() {\r\n\t\t\tif (this.setAcceptForm.multiConfigs.length <= 1) return;\r\n\t\t\tthis.setAcceptForm.multiConfigs.pop();\r\n\t\t},\r\n\t\tcancel(formName) {\r\n\t\t\tthis.$refs[formName].clearValidate();\r\n\t\t\tthis.setAcceptForm = JSON.parse(JSON.stringify(this.keepForm));\r\n\t\t\tthis.isEdit = false;\r\n\t\t},\r\n\t\trest(formName) {\r\n\t\t\tthis.$confirm('确认清空吗？', '提示', {\r\n\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\ttype: 'warning'\r\n\t\t\t})\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tthis.$refs[formName].resetFields();\r\n\t\t\t\t\tthis.$refs.content.setContent('');\r\n\t\t\t\t})\r\n\t\t\t\t.catch(() => {});\r\n\t\t},\r\n\t\tasync saveAcceptAward() {\r\n\t\t\tlet postData = JSON.parse(JSON.stringify(this.setAcceptForm));\r\n\t\t\tlet url;\r\n\t\t\t// 元 转 分\r\n\t\t\tpostData = formatUnit(postData);\r\n\t\t\tpostData.config.startTime = this.$moment().format('YYYY-MM-DD HH:mm:ss');\r\n\t\t\tpostData.config.endTime = this.$moment().format('YYYY-MM-DD HH:mm:ss');\r\n\t\t\tif (this.isUpdate) {\r\n\t\t\t\turl = this.BASE_URL + `admin/activity/config/update?id=${postData.config.id}`;\r\n\t\t\t} else {\r\n\t\t\t\turl = this.BASE_URL + 'admin/activity/config';\r\n\t\t\t}\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code, data, message }\r\n\t\t\t} = await this.$axios.post(url, postData);\r\n\t\t\tif (code == '200') {\r\n\t\t\t\tthis.isEdit = false;\r\n\t\t\t\tthis.$message.success(message);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsubmitForm(formName) {\r\n\t\t\tthis.$refs[formName].validate(valid => {\r\n\t\t\t\tif (valid) {\r\n\t\t\t\t\tlet msg;\r\n\t\t\t\t\tif (this.isUpdate) {\r\n\t\t\t\t\t\tmsg = '确定修改吗';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmsg = '确定添加吗';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.$confirm(msg, '提示', {\r\n\t\t\t\t\t\tconfirmButtonText: '确定',\r\n\t\t\t\t\t\tcancelButtonText: '取消',\r\n\t\t\t\t\t\ttype: 'warning'\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tthis.saveAcceptAward();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch(() => {});\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tasync getData() {\r\n\t\t\tlet params = { type: '2' };\r\n\t\t\tlet {\r\n\t\t\t\tdata: { code, data, message }\r\n\t\t\t} = await this.$axios.get(this.BASE_URL + 'admin/activity/config/type/detail', { params });\r\n\t\t\tif (code == 200) {\r\n\t\t\t\tthis.setAcceptForm = formatUnit(data, true);\r\n\t\t\t\tthis.keepForm = JSON.parse(JSON.stringify(this.setAcceptForm));\r\n\t\t\t\tthis.isUpdate = true; //执行修改\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.isUpdate = false; //执行添加\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\tthis.getData();\r\n\t}\r\n};\r\n</script>"],"sourceRoot":"src/main/activity"}]}